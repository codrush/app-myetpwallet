(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{T2jK:function(e,t,i){"use strict";i.r(t),i.d(t,"OpenQrPageModule",(function(){return I}));var n=i("ofXK"),o=i("3Pt+"),s=i("TEn/"),c=i("tyNb"),r=i("mrSG"),a=i("gddX"),l=i("fXoL"),d=i("3LUQ"),b=i("OaWH"),p=i("Fvwb"),h=i("BZA/"),f=i("sYmb");function u(e,t){if(1&e&&(l.Xb(0,"ion-col",6),l.Xb(1,"ion-card"),l.Xb(2,"ion-card-header"),l.Sb(3,"ion-card-title",7),l.Wb(),l.Xb(4,"ion-card-content"),l.Sb(5,"p",7),l.Sb(6,"img",8),l.Wb(),l.Wb(),l.Wb()),2&e){const e=t.$implicit;l.Fb(3),l.pc("translate","IMPORT_QR.HOW_TO_IMPORT_WALLET_MOBILE_STEP"+e),l.Fb(2),l.pc("translate","IMPORT_QR.HOW_TO_IMPORT_WALLET_MOBILE_STEP"+e+"_TEXT"),l.Fb(1),l.pc("src","/assets/images/mobile_import_"+e+".jpeg",l.Cc)}}const S=function(){return[1,2,3]};function g(e,t){1&e&&(l.Xb(0,"div"),l.Sb(1,"h2",4),l.Xb(2,"ion-grid"),l.Xb(3,"ion-row"),l.Gc(4,u,7,3,"ion-col",5),l.Wb(),l.Wb(),l.Wb()),2&e&&(l.Fb(4),l.pc("ngForOf",l.sc(1,S)))}function v(e,t){if(1&e){const e=l.Yb();l.Xb(0,"ion-button",11),l.fc("click",(function(){return l.Ac(e),l.jc(2).scan()})),l.Sb(1,"ion-icon",12),l.Sb(2,"span",13),l.Wb()}}function w(e,t){if(1&e&&(l.Xb(0,"ion-row"),l.Xb(1,"ion-col",9),l.Gc(2,v,3,0,"ion-button",10),l.Wb(),l.Wb()),2&e){const e=l.jc();l.Fb(2),l.pc("ngIf",!e.qrCodeLoaded)}}function R(e,t){if(1&e){const e=l.Yb();l.Xb(0,"ion-row"),l.Xb(1,"ion-col",9),l.Xb(2,"ion-button",17),l.fc("click",(function(){l.Ac(e);const t=l.jc(2);return t.decrypt(t.password,t.seed)})),l.Sb(3,"ion-icon",12),l.Sb(4,"span",18),l.Wb(),l.Wb(),l.Wb()}if(2&e){const e=l.jc(2);l.Fb(2),l.pc("disabled",!e.passwordValid(e.password))}}function O(e,t){if(1&e){const e=l.Yb();l.Xb(0,"div"),l.Xb(1,"ion-row"),l.Sb(2,"ion-icon",14),l.Wb(),l.Xb(3,"ion-item"),l.Sb(4,"ion-label",15),l.Xb(5,"ion-input",16),l.fc("ngModelChange",(function(t){return l.Ac(e),l.jc().password=t})),l.Wb(),l.Wb(),l.Gc(6,R,5,1,"ion-row",3),l.Wb()}if(2&e){const e=l.jc();l.Fb(5),l.pc("ngModel",e.password),l.Fb(1),l.pc("ngIf",!e.isMobile)}}function m(e,t){if(1&e){const e=l.Yb();l.Xb(0,"ion-button",21),l.fc("click",(function(){return l.Ac(e),l.jc(2).scan()})),l.Sb(1,"ion-icon",12),l.Sb(2,"span",13),l.Wb()}}function W(e,t){if(1&e){const e=l.Yb();l.Xb(0,"ion-button",22),l.fc("click",(function(){l.Ac(e);const t=l.jc(2);return t.decrypt(t.password,t.seed)})),l.Sb(1,"ion-icon",12),l.Sb(2,"span",18),l.Wb()}if(2&e){const e=l.jc(2);l.pc("disabled",!e.passwordValid(e.password))}}function M(e,t){if(1&e&&(l.Xb(0,"ion-footer"),l.Gc(1,m,3,0,"ion-button",19),l.Gc(2,W,3,1,"ion-button",20),l.Wb()),2&e){const e=l.jc();l.Fb(1),l.pc("ngIf",!e.qrCodeLoaded),l.Fb(1),l.pc("ngIf",e.qrCodeLoaded)}}const T=[{path:"",component:(()=>{class e{constructor(e,t,i,n,o,s){this.modalCtrl=e,this.alertService=t,this.appService=i,this.walletService=n,this.metaverseService=o,this.router=s,this.passwordValid=e=>!!e&&e.length>0}ngOnInit(){return Object(r.a)(this,void 0,void 0,(function*(){this.isMobile=this.walletService.isMobile()}))}scan(){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield this.modalCtrl.create({component:a.a,showBackdrop:!1,backdropDismiss:!1});e.onWillDismiss().then(t=>{t.data&&t.data.text&&this.alertService.showLoading().then(()=>{const e=t.data.text.toString().split("&");this.seed=e[0];const i=e[1];this.index=Math.max(5,Math.min(parseInt(e[2],10),50));const n=e[3];e.length<3||e.length>4?(this.alertService.stopLoading(),this.alertService.showError("IMPORT_QR.MESSAGE.ERROR_QRCODE","")):this.appService.getNetwork().then(e=>{i!==e.charAt(0)?(this.alertService.stopLoading(),this.alertService.showError("IMPORT_QR.MESSAGE.ERROR_NETWORK_MISMATCH","")):this.seed?(this.qrCodeLoaded=!0,this.alertService.stopLoading()):n?this.walletService.getWalletFromMasterPublicKey(n).then(e=>this.walletService.generateAddresses(e,0,this.index)).then(e=>this.metaverseService.addAddresses(e)).then(()=>this.walletService.setXpub(n)).then(()=>this.router.navigate(["/loading"],{state:{data:{reset:!0}}})).then(()=>this.alertService.stopLoading()):(this.alertService.stopLoading(),this.alertService.showError("IMPORT_QR.MESSAGE.ERROR_QRCODE",""))})}),e.remove()}),yield e.present()}))}decrypt(e,t){return Object(r.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading(),yield this.walletService.setMobileWallet(t);const i=yield this.walletService.getMasterPublicKey(e);yield this.walletService.setXpub(i);const n=yield this.walletService.getWallet(e),o=yield this.walletService.generateAddresses(n,0,this.index);yield this.metaverseService.setAddresses(o),yield this.walletService.saveSessionAccount(e),this.alertService.stopLoading(),this.router.navigate(["/loading"],{state:{data:{reset:!0}}})}catch(i){console.error(i),this.alertService.showError("IMPORT_QR.MESSAGE.PASSWORD_WRONG",""),this.alertService.stopLoading()}}))}}return e.\u0275fac=function(t){return new(t||e)(l.Rb(s.bb),l.Rb(d.a),l.Rb(b.a),l.Rb(p.a),l.Rb(h.a),l.Rb(c.h))},e.\u0275cmp=l.Lb({type:e,selectors:[["app-open-qr"]],decls:10,vars:4,consts:[["slot","start"],["defaultHref","/login/open"],["translate","IMPORT_QR.TITLE"],[4,"ngIf"],["translate","IMPORT_QR.HOW_IT_WORKS",1,"ion-text-center"],["size","12","size-md","4",4,"ngFor","ngForOf"],["size","12","size-md","4"],[3,"translate"],["alt","",3,"src"],["size","12","size-sm","6","offset-sm","3"],["expand","full","fill","outline","shape","round",3,"click",4,"ngIf"],["expand","full","fill","outline","shape","round",3,"click"],["slot","start","name","qr-code"],["translate","IMPORT_QR.BUTTON.SCAN"],["name","checkmark-circle",1,"verifiedQRCode"],["color","primary","position","floating","translate","GLOBAL.PASSWORD"],["name","password","type","password","required","",3,"ngModel","ngModelChange"],["type","submit","expand","full","fill","outline","shape","round","color","primary",3,"disabled","click"],["translate","IMPORT_QR.BUTTON.IMPORT_WALLET"],["expand","full",3,"click",4,"ngIf"],["expand","full",3,"disabled","click",4,"ngIf"],["expand","full",3,"click"],["expand","full",3,"disabled","click"]],template:function(e,t){1&e&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-buttons",0),l.Sb(3,"ion-back-button",1),l.Wb(),l.Sb(4,"ion-title",2),l.Wb(),l.Wb(),l.Xb(5,"ion-content"),l.Gc(6,g,5,2,"div",3),l.Gc(7,w,3,1,"ion-row",3),l.Gc(8,O,7,2,"div",3),l.Wb(),l.Gc(9,M,3,2,"ion-footer",3)),2&e&&(l.Fb(6),l.pc("ngIf",t.qrCodeLoaded),l.Fb(1),l.pc("ngIf",!t.isMobile),l.Fb(1),l.pc("ngIf",t.qrCodeLoaded),l.Fb(1),l.pc("ngIf",t.isMobile))},directives:[s.u,s.X,s.j,s.f,s.g,s.V,f.a,s.r,n.m,s.t,s.K,n.l,s.q,s.k,s.m,s.o,s.l,s.i,s.v,s.x,s.z,s.w,s.hb,o.n,o.i,o.l,s.s],styles:[".verifiedQRCode[_ngcontent-%COMP%]{color:var(--ion-color-secondary);font-size:50px;margin-left:calc(50% - 25px)}ion-card[_ngcontent-%COMP%]{height:100%}"]}),e})()}];let _=(()=>{class e{}return e.\u0275mod=l.Pb({type:e}),e.\u0275inj=l.Ob({factory:function(t){return new(t||e)},imports:[[c.j.forChild(T)],c.j]}),e})(),I=(()=>{class e{}return e.\u0275mod=l.Pb({type:e}),e.\u0275inj=l.Ob({factory:function(t){return new(t||e)},imports:[[n.c,o.e,s.Y,f.c.forChild(),_]]}),e})()}}]);