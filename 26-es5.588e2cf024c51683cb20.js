!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"4bAk":function(n,a,o){"use strict";o.r(a),o.d(a,"CreatePageModule",(function(){return X}));var i=o("ofXK"),r=o("3Pt+"),s=o("TEn/"),c=o("tyNb"),l=o("fXoL"),b=o("3LUQ"),d=o("sYmb"),u=o("BZA/"),f=o("q5gJ");function g(e,n){1&e&&l.Sb(0,"ion-item",31)}function m(e,n){1&e&&l.Sb(0,"ion-item",32)}function h(e,n){if(1&e&&(l.Xb(0,"ion-select-option",35),l.Ic(1),l.Wb()),2&e){var t=n.$implicit;l.qc("value",t.symbol),l.Fb(1),l.Jc(t.symbol)}}function p(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-select",33),l.fc("ngModelChange",(function(e){return l.Ac(t),l.jc().recipient_avatar=e}))("ngModelChange",(function(){return l.Ac(t),l.jc().avatarChanged()})),l.kc(1,"translate"),l.kc(2,"translate"),l.Gc(3,h,2,2,"ion-select-option",34),l.Wb()}if(2&e){var a=l.jc();l.qc("okText",l.lc(1,4,"OK")),l.qc("cancelText",l.lc(2,6,"CANCEL")),l.pc("ngModel",a.recipient_avatar),l.Fb(3),l.pc("ngForOf",a.avatars)}}function v(e,n){if(1&e){var t=l.Yb();l.Xb(0,"ion-input",36),l.fc("ngModelChange",(function(e){return l.Ac(t),l.jc().no_avatar_placeholder=e})),l.Wb()}if(2&e){var a=l.jc();l.pc("ngModel",a.no_avatar_placeholder)}}function E(e,n){1&e&&l.Sb(0,"ion-item",37)}function T(e,n){if(1&e){var t=l.Yb();l.Xb(0,"div"),l.Xb(1,"ion-item",38),l.Sb(2,"ion-label",39),l.Xb(3,"ion-badge",40),l.Ic(4),l.kc(5,"format"),l.Wb(),l.Wb(),l.Xb(6,"ion-item"),l.Xb(7,"ion-range",41),l.fc("ngModelChange",(function(e){return l.Ac(t),l.jc().fee=e})),l.Xb(8,"ion-label",42),l.Ic(9),l.kc(10,"format"),l.Wb(),l.Xb(11,"ion-label",43),l.Ic(12),l.kc(13,"format"),l.Wb(),l.Wb(),l.Wb(),l.Wb()}if(2&e){var a=l.jc();l.Fb(4),l.Kc("",l.mc(5,4,a.fee,8)," ETP"),l.Fb(3),l.pc("ngModel",a.fee),l.Fb(2),l.Jc(l.mc(10,7,1e4,8)),l.Fb(3),l.Jc(l.mc(13,10,1e7,8))}}var _,A,C,M=function(e){return{fee:e}},S=function(e){return{"error-border":e}},y=[{path:"",component:(_=function(){function n(t,a,o,i,r){var s=this;e(this,n),this.alertService=t,this.platform=a,this.router=o,this.translate=i,this.metaverseService=r,this.symbol="",this.recipient_address=history.state.data&&history.state.data.avatar_address?history.state.data.avatar_address:"",this.recipient_avatar=history.state.data&&history.state.data.avatar_name?history.state.data.avatar_name:"",this.content="",this.no_avatar=!1,this.defaultFee=1e4,this.fee=1e5,this.symbol_available=!1,this.showAdvanced=!1,this.validSymbol=function(e){return/^[A-Za-z0-9._\-]{3,64}$/g.test(e)&&s.symbol_available},this.validContent=function(e){return void 0===e||e.length<253},this.validName=function(e){return void 0!==e&&e.length>0},this.validAddress=function(e){return void 0!==e&&e.length>0},this.avatarChanged=function(){s.avatars.forEach((function(e){e.symbol!==s.recipient_avatar||(s.recipient_address=e.address)}))},this.symbolChanged=function(){s.symbol&&s.symbol.length>=3&&(s.symbol=s.symbol.trim(),Promise.all([s.metaverseService.suggestMIT(s.symbol),s.symbol]).then((function(e){if(s.symbol!==e[1])throw"";s.symbol_available=e[0][0]!==s.symbol})).catch((function(e){s.symbol_available=!1})))},this.recipient_address||this.translate.get("CREATE_MIT.SELECT_AVATAR").subscribe((function(e){s.recipient_address=e})),this.translate.get("CREATE_MIT.NO_AVATAR_PLACEHOLDER").subscribe((function(e){s.no_avatar_placeholder=e})),Promise.all([this.metaverseService.getAddressBalances(),this.metaverseService.listAvatars()]).then((function(e){s.avatars=e[1],0===s.avatars.length&&(s.no_avatar=!0);var n=e[0],t=[];Object.keys(n).length&&Object.keys(n).forEach((function(e){n[e].ETP&&n[e].ETP.available>=1e4&&(t.push({address:e,available:n[e].ETP.available}),s.avatars.forEach((function(n){n.address===e&&t.pop()})))})),s.addressbalances=t})),this.defaultFee=this.fee,this.metaverseService.getFees().then((function(e){s.fee=e.mitIssue,s.defaultFee=s.fee}))}return t(n,[{key:"ngOnInit",value:function(){}},{key:"create",value:function(){var e=this;return this.alertService.showLoading().then((function(){return e.metaverseService.createRegisterMITTx(e.recipient_address,e.recipient_avatar,e.symbol,e.content,void 0,e.showAdvanced?e.fee:e.defaultFee)})).catch((function(n){switch(console.error(n),e.alertService.stopLoading(),n.message){case"ERR_CONNECTION":e.alertService.showError("SEND.MESSAGE.ERROR_SEND_TEXT","");break;case"ERR_BROADCAST":e.translate.get("SEND.MESSAGE.ONE_TX_PER_BLOCK").subscribe((function(n){e.alertService.showError("SEND.MESSAGE.BROADCAST_ERROR",n)}));break;case"ERR_INSUFFICIENT_BALANCE":e.alertService.showError("SEND.MESSAGE.INSUFFICIENT_BALANCE","");break;default:e.alertService.showError("SEND.MESSAGE.CREATE_TRANSACTION",n.message)}}))}},{key:"send",value:function(){var e=this;this.create().then((function(n){var t=n.encode().toString("hex");e.router.navigate(["account","confirm"],{state:{data:{tx:t}}}),e.alertService.stopLoading()}))}}]),n}(),_.\u0275fac=function(e){return new(e||_)(l.Rb(b.a),l.Rb(s.eb),l.Rb(c.h),l.Rb(d.e),l.Rb(u.a))},_.\u0275cmp=l.Lb({type:_,selectors:[["app-create"]],decls:44,vars:29,consts:[["slot","start"],["defaultHref","/account/mit"],["translate","CREATE_MIT.TITLE"],["align","center","translate","CREATE_MIT.INFORMATION"],["translate","CREATE_MIT.FEE_WARNING",1,"right",3,"translateParams"],[3,"ngSubmit"],["sendForm","ngForm"],[3,"ngClass"],["color","primary","position","floating","translate","CREATE_MIT.SYMBOL"],["name","symbol","maxlength","63","required","",3,"ngModel","ngModelChange"],["lines","none","class","wrong-input","translate","CREATE_MIT.MIT_ALREADY_EXIST",4,"ngIf"],["lines","none","class","wrong-input","translate","CREATE_MIT.MIT_SYMBOL_TOO_SHORT",4,"ngIf"],["color","primary","position","floating","translate","CREATE_MIT.CONTENT"],["name","content","maxlength","252",3,"ngModel","ngModelChange"],["color","primary","position","floating","translate","CREATE_MIT.AVATAR_NAME"],["name","recipient_avatar","multiple","false",3,"ngModel","okText","cancelText","ngModelChange",4,"ngIf"],["name","no_avatar","disabled","",3,"ngModel","ngModelChange",4,"ngIf"],["lines","none","class","wrong-input","translate","CREATE_MIT.NO_AVATAR",4,"ngIf"],["color","primary","position","floating","translate","CREATE_MIT.RECIPIENT_ADDRESS"],["name","recipient_address","disabled","",3,"ngModel","ngModelChange"],[1,"toggle-input"],["translate","CREATE_MIT.SHOW_ADVANCED"],["name","showAdvanced","checked","false",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"padding-bottom"],["color","danger","fill","outline","shape","round","expand","full","routerLink","/account/mit"],["slot","start","name","close"],["translate","CREATE_MIT.BUTTON.CANCEL"],["expand","full","type","submit","fill","outline","shape","round","color","primary",3,"disabled"],["slot","start","disabled","checked","name","cog"],["translate","CREATE_MIT.BUTTON.NEXT"],["lines","none","translate","CREATE_MIT.MIT_ALREADY_EXIST",1,"wrong-input"],["lines","none","translate","CREATE_MIT.MIT_SYMBOL_TOO_SHORT",1,"wrong-input"],["name","recipient_avatar","multiple","false",3,"ngModel","okText","cancelText","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","no_avatar","disabled","",3,"ngModel","ngModelChange"],["lines","none","translate","CREATE_MIT.NO_AVATAR",1,"wrong-input"],["lines","none"],["color","primary","translate","CREATE_MIT.FEE"],["item-end","","color","primary"],["min","10000","max","10000000","step","10000","color","primary","name","fee",3,"ngModel","ngModelChange"],["range-left",""],["range-right",""]],template:function(e,n){if(1&e&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-buttons",0),l.Sb(3,"ion-back-button",1),l.Wb(),l.Sb(4,"ion-title",2),l.Wb(),l.Wb(),l.Xb(5,"ion-content"),l.Xb(6,"ion-row"),l.Xb(7,"ion-col"),l.Sb(8,"p",3),l.Wb(),l.Wb(),l.Xb(9,"ion-row"),l.Sb(10,"ion-col",4),l.kc(11,"format"),l.Wb(),l.Xb(12,"form",5,6),l.fc("ngSubmit",(function(){return n.send()})),l.Xb(14,"ion-list"),l.Xb(15,"ion-item",7),l.Sb(16,"ion-label",8),l.Xb(17,"ion-input",9),l.fc("ngModelChange",(function(e){return n.symbol=e}))("ngModelChange",(function(){return n.symbolChanged()})),l.Wb(),l.Wb(),l.Gc(18,g,1,0,"ion-item",10),l.Gc(19,m,1,0,"ion-item",11),l.Xb(20,"ion-item",7),l.Sb(21,"ion-label",12),l.Xb(22,"ion-input",13),l.fc("ngModelChange",(function(e){return n.content=e})),l.Wb(),l.Wb(),l.Xb(23,"ion-item",7),l.Sb(24,"ion-label",14),l.Gc(25,p,4,8,"ion-select",15),l.Gc(26,v,1,1,"ion-input",16),l.Wb(),l.Gc(27,E,1,0,"ion-item",17),l.Xb(28,"ion-item",7),l.Sb(29,"ion-label",18),l.Xb(30,"ion-input",19),l.fc("ngModelChange",(function(e){return n.recipient_address=e})),l.Wb(),l.Wb(),l.Xb(31,"ion-item",20),l.Sb(32,"ion-label",21),l.Xb(33,"ion-toggle",22),l.fc("ngModelChange",(function(e){return n.showAdvanced=e})),l.Wb(),l.Wb(),l.Gc(34,T,14,13,"div",23),l.Wb(),l.Xb(35,"ion-row",24),l.Xb(36,"ion-col"),l.Xb(37,"ion-button",25),l.Sb(38,"ion-icon",26),l.Sb(39,"span",27),l.Wb(),l.Wb(),l.Xb(40,"ion-col"),l.Xb(41,"ion-button",28),l.Sb(42,"ion-icon",29),l.Sb(43,"span",30),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Wb()),2&e){var t=l.yc(13);l.Fb(10),l.pc("translateParams",l.tc(19,M,l.mc(11,16,n.fee,8))),l.Fb(5),l.pc("ngClass",l.tc(21,S,!n.validSymbol(n.symbol))),l.Fb(2),l.pc("ngModel",n.symbol),l.Fb(1),l.pc("ngIf",n.symbol.length>=3&&!n.symbol_available),l.Fb(1),l.pc("ngIf",n.symbol.length>0&&n.symbol.length<3),l.Fb(1),l.pc("ngClass",l.tc(23,S,!n.validContent(n.content))),l.Fb(2),l.pc("ngModel",n.content),l.Fb(1),l.pc("ngClass",l.tc(25,S,!n.validName(n.recipient_avatar))),l.Fb(2),l.pc("ngIf",!n.no_avatar),l.Fb(1),l.pc("ngIf",n.no_avatar),l.Fb(1),l.pc("ngIf",n.no_avatar),l.Fb(1),l.pc("ngClass",l.tc(27,S,!n.validAddress(n.recipient_address))),l.Fb(2),l.pc("ngModel",n.recipient_address),l.Fb(3),l.pc("ngModel",n.showAdvanced),l.Fb(1),l.pc("ngIf",n.showAdvanced),l.Fb(7),l.pc("disabled",!(t.form.valid&&n.validSymbol(n.symbol)&&n.validContent(n.content)&&n.validName(n.recipient_avatar)&&n.validAddress(n.recipient_address)))}},directives:[s.u,s.X,s.j,s.f,s.g,s.V,d.a,s.r,s.K,s.q,r.p,r.j,r.k,s.A,s.x,i.k,s.z,s.w,s.hb,r.f,r.n,r.i,r.l,i.m,s.W,s.c,s.i,s.fb,c.i,s.v,s.N,s.gb,i.l,s.O,s.h,s.G],pipes:[f.a,d.d],styles:[""]}),_)}],I=((A=function n(){e(this,n)}).\u0275mod=l.Pb({type:A}),A.\u0275inj=l.Ob({factory:function(e){return new(e||A)},imports:[[c.j.forChild(y)],c.j]}),A),R=o("iTUp"),X=((C=function n(){e(this,n)}).\u0275mod=l.Pb({type:C}),C.\u0275inj=l.Ob({factory:function(e){return new(e||C)},imports:[[i.c,r.e,s.Y,d.c.forChild(),R.a,I]]}),C)},q5gJ:function(n,a,o){"use strict";o.d(a,"a",(function(){return r}));var i=o("fXoL"),r=function(){var n=function(){function n(){e(this,n)}return t(n,[{key:"transform",value:function(e,n){return(e/Math.pow(10,n)).toLocaleString(void 0,{maximumFractionDigits:n})}}]),n}();return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=i.Qb({name:"format",type:n,pure:!0}),n}()}}])}();