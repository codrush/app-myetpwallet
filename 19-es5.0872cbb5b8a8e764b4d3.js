!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{grBA:function(e,r,o){"use strict";o.r(r),o.d(r,"ConfirmVmPageModule",(function(){return G}));var a=o("ofXK"),s=o("3Pt+"),i=o("TEn/"),c=o("tyNb"),u=o("mrSG"),b=o("fXoL"),p=o("BZA/"),l=o("Fvwb"),h=o("3LUQ"),m=o("m5Kd"),d=o("sYmb"),f=o("R0Ic"),v=o("OaWH"),g=o("q5gJ");function R(t,e){1&t&&b.Sb(0,"ion-spinner",2)}function O(t,e){if(1&t&&(b.Xb(0,"div",17),b.Ic(1),b.kc(2,"format"),b.Wb()),2&t){var n=b.jc(3);b.Fb(1),b.Kc(" -",b.mc(2,1,n.params.value,18)," ETP ")}}function T(t,e){if(1&t&&(b.Xb(0,"div",18),b.Ic(1),b.kc(2,"format"),b.Wb()),2&t){var n=b.jc(3);b.Fb(1),b.Kc(" +",b.mc(2,1,n.params.value,18)," ETP ")}}function S(t,e){if(1&t&&(b.Xb(0,"div"),b.Ic(1),b.kc(2,"format"),b.Sb(3,"div",19),b.Wb()),2&t){var n=b.jc(3);b.Fb(1),b.Kc(" ",b.mc(2,1,n.params.value,18)," ETP ")}}function E(t,e){if(1&t&&(b.Xb(0,"div",14),b.Gc(1,O,3,4,"div",15),b.Gc(2,T,3,4,"div",16),b.Gc(3,S,4,4,"div",1),b.Wb()),2&t){var n=b.jc(2);b.Fb(1),b.pc("ngIf",n.myAddress(n.from)&&!n.myAddress(n.params.to)),b.Fb(1),b.pc("ngIf",!n.myAddress(n.from)&&n.myAddress(n.params.to)),b.Fb(1),b.pc("ngIf",n.myAddress(n.from)&&n.myAddress(n.params.to))}}function _(t,e){if(1&t&&(b.Xb(0,"div",20),b.Ic(1),b.kc(2,"translate"),b.kc(3,"format"),b.Wb()),2&t){var n=b.jc(2);b.Fb(1),b.Lc(" ",b.lc(2,2,"TX.TX_FEE"),": ",b.mc(3,4,n.txFee,8)," ETP ")}}var C=function(t){return{personal:t}};function M(t,e){if(1&t&&(b.Xb(0,"ion-card"),b.Xb(1,"ion-item",3),b.Xb(2,"ion-grid"),b.Xb(3,"ion-row"),b.Xb(4,"ion-col"),b.Sb(5,"h1",4),b.Wb(),b.Wb(),b.Xb(6,"ion-row"),b.Xb(7,"ion-col"),b.Xb(8,"ion-row"),b.Xb(9,"ion-col",5),b.Xb(10,"div",6),b.Xb(11,"div"),b.Ic(12),b.kc(13,"translate"),b.Wb(),b.Wb(),b.Wb(),b.Xb(14,"ion-col",7),b.Gc(15,E,4,3,"div",8),b.Sb(16,"br"),b.Gc(17,_,4,7,"div",9),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Xb(18,"ion-row"),b.Xb(19,"ion-col",5),b.Xb(20,"ion-row"),b.Sb(21,"ion-col",10),b.Wb(),b.Xb(22,"ion-row",11),b.Xb(23,"ion-col"),b.Ic(24),b.Wb(),b.Wb(),b.Wb(),b.Xb(25,"ion-col",12),b.Xb(26,"ion-row"),b.Sb(27,"ion-col",13),b.Wb(),b.Xb(28,"ion-row",11),b.Xb(29,"ion-col"),b.Ic(30),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()),2&t){var n=b.jc();b.Fb(12),b.Jc(b.lc(13,7,"TX.TX_TYPE."+n.txType)),b.Fb(3),b.pc("ngIf","VM_ETP"==n.txType),b.Fb(2),b.pc("ngIf",n.txFee),b.Fb(5),b.pc("ngClass",b.tc(9,C,n.myAddress(n.from))),b.Fb(2),b.Kc(" ",n.from," "),b.Fb(4),b.pc("ngClass",b.tc(11,C,n.myAddress(n.params.to))),b.Fb(2),b.Kc(" ",n.params.to," ")}}var w,I=((w=function(){function e(n,r,o){var a=this;t(this,e),this.appService=n,this.walletService=r,this.translate=o,this.decimalsMst={},this.totalInputs={ETP:0,MST:{}},this.totalOutputs={ETP:0,MST:{}},this.totalPersonalInputs={ETP:0,MST:{}},this.totalPersonalOutputs={ETP:0,MST:{}},this.txFee=0,this.txType="VM_ETP",this.checkTx=function(){return console.log("TODO")},this.explorerURL=function(t){return"mainnet"===a.appService.network?"https://explorer.mvs.org/tx/"+t:"https://explorer-testnet.mvs.org/tx/"+t},console.log(this.params)}return n(e,[{key:"ngOnChanges",value:function(t){}},{key:"myAddress",value:function(t){return this.addresses.indexOf(t)>-1}}]),e}()).\u0275fac=function(t){return new(t||w)(b.Rb(v.a),b.Rb(l.a),b.Rb(d.e))},w.\u0275cmp=b.Lb({type:w,selectors:[["tx-item-vm"]],inputs:{params:"params",status:"status",addresses:"addresses",height:"height",from:"from"},features:[b.Db],decls:2,vars:2,consts:[["name","dots",4,"ngIf"],[4,"ngIf"],["name","dots"],["button","","lines","none",1,"manual-copy","display-overflow"],["translate","TX.TX_SUMMARY"],["size","12","size-sm","6"],[1,"summaryTxType"],["size","12","size-sm","6",1,"summaryAmount"],["class","right",4,"ngIf"],["class","fee right",4,"ngIf"],["translate","TX_VM.FROM"],[3,"ngClass"],["size","12","size-sm","6",1,"right"],["translate","TX_VM.TO"],[1,"right"],["class","sendAmount",4,"ngIf"],["class","receiveAmount",4,"ngIf"],[1,"sendAmount"],[1,"receiveAmount"],["translate","TX.INTRAWALLET"],[1,"fee","right"]],template:function(t,e){1&t&&(b.Gc(0,R,1,0,"ion-spinner",0),b.Gc(1,M,31,13,"ion-card",1)),2&t&&(b.pc("ngIf",!e.params),b.Fb(1),b.pc("ngIf",e.params))},directives:[a.m,i.R,i.k,i.x,i.t,i.K,i.q,d.a,a.k],pipes:[d.d,g.a],styles:[".hash[_ngcontent-%COMP%]{margin-top:10px;--min-height:16px}.hash[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.timestamp[_ngcontent-%COMP%]{margin:0;--min-height:16px}.summaryTxType[_ngcontent-%COMP%]{font-size:20px}.summaryAmount[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:20px;float:right;--min-height:20px}.sendAmount[_ngcontent-%COMP%]{color:var(--ion-color-danger)!important}.receiveAmount[_ngcontent-%COMP%]{color:#32db64!important}.hash[_ngcontent-%COMP%]{overflow:hidden;word-break:break-all;text-overflow:ellipsis;overflow-wrap:break-word}.fee[_ngcontent-%COMP%]{font-size:16px!important;color:var(--ion-color-dark)!important}.unsigned[_ngcontent-%COMP%]{color:var(--ion-color-primary)}textarea[_ngcontent-%COMP%]{width:100%;border:0!important;resize:none;font-size:1.8rem;margin:20px}.hash[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding-bottom:0}.hash[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.hash[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{padding-top:10px}.hash[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{top:-10px}.tx-hash[_ngcontent-%COMP%]{width:calc(100% - 45px);display:inline-block}.card[_ngcontent-%COMP%]{margin-left:10px;width:calc(100% - 20px)}.show-more-btn[_ngcontent-%COMP%]{margin-left:20px}ion-grid[_ngcontent-%COMP%]{width:100%}.tx-link-button[_ngcontent-%COMP%]{top:40%;transform:translateY(-40%)}.personal[_ngcontent-%COMP%]{font-weight:700}"],data:{animation:[Object(f.i)("expandCollapse",[Object(f.h)("* => void",[Object(f.g)({height:"*"}),Object(f.e)(500,Object(f.g)({height:"0"}))])])]}}),w),x=function(t){return{"error-border":t}};function A(t,e){if(1&t){var n=b.Yb();b.Xb(0,"ion-item",13),b.Sb(1,"ion-label",14),b.Xb(2,"ion-input",15),b.fc("ngModelChange",(function(t){return b.Ac(n),b.jc().passphrase=t})),b.Wb(),b.Wb()}if(2&t){var r=b.jc();b.pc("ngClass",b.tc(2,x,!r.validPassword(r.passphrase))),b.Fb(2),b.pc("ngModel",r.passphrase)}}var N,X,y,F,P=function(t){return[t]},k=[{path:"",component:(N=function(){function e(n,r,o,a,s){t(this,e),this.mvs=n,this.router=r,this.walletService=o,this.alertService=a,this.vmService=s,this.passphrase="",this.showAdvanced=!1,this.vmAddress={},this.validPassword=function(t){return t.length>0}}return n(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewDidEnter",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.params=history.state.data?history.state.data.params:void 0,void 0!==this.params){t.next=4;break}this.router.navigate(["account","portfolio"]),t.next=8;break;case 4:return t.next=6,this.walletService.getVmAddresses();case 6:e=t.sent,this.vmAddress=e[0]||{};case 8:case"end":return t.stop()}}),t,this)})))}},{key:"cancel",value:function(){this.router.navigate(["account","portfolio"])}},{key:"home",value:function(t){this.router.navigate(["account","portfolio"])}},{key:"send",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.alertService.showLoading();case 3:return t.next=5,this.sign();case 5:return e=t.sent,t.next=8,this.broadcast(e);case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,this,[[0,10]])})))}},{key:"broadcastOnly",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.alertService.showLoading();case 3:return e.next=5,this.broadcast(t);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"broadcast",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mvs.send(t);case 3:n=e.sent,this.alertService.stopLoading(),this.router.navigate(["account","portfolio"]),this.alertService.showMessage("CONFIRM.CONFIRM_ALERT.TITLE","CONFIRM.CONFIRM_ALERT.SUBTITLE",n.hash,"CONFIRM.CONFIRM_ALERT.OK"),e.next=16;break;case 7:e.prev=7,e.t0=e.catch(0),e.t1=(this.alertService.stopLoading(),console.error(e.t0.message),e.t0.message),e.next="ERR_CONNECTION"===e.t1?12:"ERR_SIGN_TX"===e.t1?14:15;break;case 12:return this.alertService.showError("CONFIRM.MESSAGE.ERROR_SEND_TEXT",""),e.abrupt("break",16);case 14:return e.abrupt("break",16);case 15:throw this.alertService.showError("CONFIRM.MESSAGE.BROADCAST_TRANSACTION",e.t0.message),Error("ERR_BROADCAST_TX");case 16:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"sign",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.vmService.sign(this.params,this.passphrase);case 3:return this.signedTx=t.sent,this.hexTx=this.signedTx.rawTransaction,t.abrupt("return",this.signedTx);case 8:t.prev=8,t.t0=t.catch(0),t.t1=(console.error(t.t0.message),this.alertService.stopLoading(),t.t0.message),t.next="ERR_DECRYPT_WALLET"===t.t1||"ERR_DECRYPT_WALLET_FROM_SEED"===t.t1?13:"ERR_INSUFFICIENT_BALANCE"===t.t1?14:"ERR_TOO_MANY_INPUTS"===t.t1?15:16;break;case 13:throw this.alertService.showError("CONFIRM.MESSAGE.PASSWORD_WRONG",""),Error("ERR_SIGN_TX");case 14:throw this.alertService.showError("CONFIRM.MESSAGE.INSUFFICIENT_BALANCE",""),Error("ERR_SIGN_TX");case 15:throw this.alertService.showErrorTranslated("CONFIRM.MESSAGE.ERROR_TOO_MANY_INPUTS","CONFIRM.MESSAGE.ERROR_TOO_MANY_INPUTS_TEXT"),Error("ERR_SIGN_TX");case 16:throw this.alertService.showError("CONFIRM.MESSAGE.SIGN_TRANSACTION",t.t0.message),Error("ERR_SIGN_TX");case 17:case"end":return t.stop()}}),t,this,[[0,8]])})))}},{key:"submit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.alertService.showLoading();case 3:return t.next=5,this.sign();case 5:return e=t.sent,t.next=8,this.vmService.send(e);case 8:this.alertService.stopLoading(),this.router.navigate(["account","portfolio"]),this.alertService.showMessage("CONFIRM.CONFIRM_ALERT.TITLE","CONFIRM.CONFIRM_ALERT.SUBTITLE","","CONFIRM.CONFIRM_ALERT.OK"),t.next=22;break;case 13:t.prev=13,t.t0=t.catch(0),t.t1=(this.alertService.stopLoading(),console.error(t.t0.message),t.t0.message),t.next="ERR_CONNECTION"===t.t1?18:"ERR_SIGN_TX"===t.t1?20:21;break;case 18:return this.alertService.showError("CONFIRM.MESSAGE.ERROR_SEND_TEXT",""),t.abrupt("break",22);case 20:return t.abrupt("break",22);case 21:throw this.alertService.showError("CONFIRM.MESSAGE.BROADCAST_TRANSACTION",t.t0.message),Error("ERR_BROADCAST_TX");case 22:case"end":return t.stop()}}),t,this,[[0,13]])})))}}]),e}(),N.\u0275fac=function(t){return new(t||N)(b.Rb(p.a),b.Rb(c.h),b.Rb(l.a),b.Rb(h.a),b.Rb(m.a))},N.\u0275cmp=b.Lb({type:N,selectors:[["app-confirm"]],decls:20,vars:8,consts:[["slot","start"],["defaultHref","/account/portfolio"],["translate","CONFIRM.TITLE"],[3,"ngSubmit"],["signTxForm","ngForm"],[3,"params","status","from","addresses"],[3,"ngClass",4,"ngIf"],["color","danger","fill","outline","shape","round","expand","full",3,"click"],["slot","start","name","close"],["translate","CONFIRM.BUTTON.CANCEL"],["type","submit","expand","full","fill","outline","shape","round","color","primary",3,"disabled"],["slot","start","name","send"],["translate","CONFIRM.BUTTON.SIGN_AND_SEND"],[3,"ngClass"],["color","primary","position","floating","translate","CONFIRM.PASSWORD"],["name","passphrase","type","password","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(b.Xb(0,"ion-header"),b.Xb(1,"ion-toolbar"),b.Xb(2,"ion-buttons",0),b.Sb(3,"ion-back-button",1),b.Wb(),b.Sb(4,"ion-title",2),b.Wb(),b.Wb(),b.Xb(5,"ion-content"),b.Xb(6,"form",3,4),b.fc("ngSubmit",(function(){return e.submit()})),b.Sb(8,"tx-item-vm",5),b.Gc(9,A,3,4,"ion-item",6),b.Sb(10,"br"),b.Xb(11,"ion-row"),b.Xb(12,"ion-col"),b.Xb(13,"ion-button",7),b.fc("click",(function(){return e.cancel()})),b.Sb(14,"ion-icon",8),b.Sb(15,"span",9),b.Wb(),b.Wb(),b.Xb(16,"ion-col"),b.Xb(17,"ion-button",10),b.Sb(18,"ion-icon",11),b.Sb(19,"span",12),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()),2&t){var n=b.yc(7);b.Fb(8),b.pc("params",e.params)("status","UNSIGNED")("from",e.vmAddress.address)("addresses",b.tc(6,P,e.vmAddress.address)),b.Fb(1),b.pc("ngIf",!e.signedTx),b.Fb(8),b.pc("disabled",!n.form.valid||!e.validPassword(e.passphrase))}},directives:[i.u,i.X,i.j,i.f,i.g,i.V,d.a,i.r,s.p,s.j,s.k,I,a.m,i.K,i.q,i.i,i.v,i.x,a.k,i.z,i.w,i.hb,s.n,s.i,s.l],styles:[""]}),N)}],W=((X=function e(){t(this,e)}).\u0275mod=b.Pb({type:X}),X.\u0275inj=b.Ob({factory:function(t){return new(t||X)},imports:[[c.j.forChild(k)],c.j]}),X),L=o("iTUp"),j=((F=function e(){t(this,e)}).\u0275mod=b.Pb({type:F}),F.\u0275inj=b.Ob({factory:function(t){return new(t||F)},imports:[[a.c,i.Y,d.c.forChild(),c.j,L.a]]}),F),G=((y=function e(){t(this,e)}).\u0275mod=b.Pb({type:y}),y.\u0275inj=b.Ob({factory:function(t){return new(t||y)},imports:[[a.c,s.e,i.Y,d.c.forChild(),L.a,j,W]]}),y)},iTUp:function(e,n,r){"use strict";r.d(n,"a",(function(){return s}));var o=r("ofXK"),a=r("fXoL"),s=function(){var e=function e(){t(this,e)};return e.\u0275mod=a.Pb({type:e}),e.\u0275inj=a.Ob({factory:function(t){return new(t||e)},imports:[[o.c]]}),e}()},q5gJ:function(e,r,o){"use strict";o.d(r,"a",(function(){return s}));var a=o("fXoL"),s=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t,e){return(t/Math.pow(10,e)).toLocaleString(void 0,{maximumFractionDigits:e})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.Qb({name:"format",type:e,pure:!0}),e}()}}])}();