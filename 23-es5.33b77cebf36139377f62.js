!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,s=void 0;try{for(var a,c=e[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(o){r=!0,s=o}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}return n}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"/wb0":function(t,i,s){"use strict";s.r(i),s.d(i,"SendVmPageModule",(function(){return G}));var a=s("ofXK"),c=s("3Pt+"),o=s("TEn/"),u=s("tyNb"),l=s("mrSG"),d=s("gddX"),b=s("fXoL"),f=s("BZA/"),p=s("Fvwb"),h=s("OaWH"),v=s("3LUQ"),g=s("m5Kd"),m=s("sYmb"),S=s("q5gJ"),A=["recipientAddressInput"],E=["quantityInput"];function I(e,t){1&e&&b.Sb(0,"ion-spinner",3)}function N(e,t){1&e&&b.Sb(0,"br")}function y(e,t){if(1&e&&(b.Xb(0,"span"),b.Ic(1),b.kc(2,"format"),b.Wb()),2&e){var n=b.jc(2);b.Fb(1),b.Lc("",b.mc(2,2,n.vmAddress.balance,n.decimals)," ",n.selectedAsset,"")}}function w(e,t){1&e&&b.Sb(0,"ion-spinner",30)}function _(e,t){1&e&&b.Sb(0,"br")}function k(e,t){1&e&&b.Sb(0,"p",31)}function T(e,t){if(1&e){var n=b.Yb();b.Xb(0,"ion-button",32),b.fc("click",(function(){return b.Ac(n),b.jc(2).scan()})),b.Sb(1,"ion-icon",33),b.Wb()}}function M(e,t){if(1&e&&(b.Xb(0,"div",34),b.Ic(1),b.kc(2,"number"),b.Wb()),2&e){var n=b.jc(2);b.Fb(1),b.Lc(" \u2248",n.base," ",b.mc(2,2,n.fiatValue(n.quantity),"1.0-2")," ")}}function D(e,t){1&e&&b.Sb(0,"ion-item",35)}var L=function(e,t){return{"error-border":e,"valid-border":t}};function R(e,t){if(1&e){var n=b.Yb();b.Xb(0,"div"),b.Xb(1,"ion-item",10),b.Sb(2,"ion-label",36),b.Xb(3,"ion-input",37),b.fc("ngModelChange",(function(e){return b.Ac(n),b.jc(2).gasPriceSatoshi=e})),b.Wb(),b.Wb(),b.Xb(4,"ion-item",10),b.Sb(5,"ion-label",38),b.Xb(6,"ion-input",39),b.fc("ngModelChange",(function(e){return b.Ac(n),b.jc(2).gas=e})),b.Wb(),b.Wb(),b.Wb()}if(2&e){var i=b.jc(2);b.Fb(1),b.pc("ngClass",b.uc(4,L,!i.validGasPrice(i.gasPriceSatoshi),i.validGasPrice(i.gasPriceSatoshi))),b.Fb(2),b.pc("ngModel",i.gasPriceSatoshi),b.Fb(1),b.pc("ngClass",b.uc(7,L,!i.validGas(i.gas),i.validGas(i.gas))),b.Fb(2),b.pc("ngModel",i.gas)}}function C(e,t){if(1&e){var n=b.Yb();b.Xb(0,"div"),b.Xb(1,"ion-row"),b.Xb(2,"ion-col"),b.Xb(3,"p",4),b.Ic(4),b.kc(5,"translate"),b.Gc(6,N,1,0,"br",2),b.Gc(7,y,3,5,"span",2),b.Gc(8,w,1,0,"ion-spinner",5),b.Wb(),b.Wb(),b.Xb(9,"ion-col"),b.Xb(10,"p",6),b.Ic(11),b.kc(12,"translate"),b.Gc(13,_,1,0,"br",2),b.Ic(14),b.kc(15,"format"),b.Wb(),b.Wb(),b.Wb(),b.Gc(16,k,1,0,"p",7),b.Xb(17,"form",8,9),b.fc("ngSubmit",(function(){return b.Ac(n),b.jc().send()}))("keyup.enter",(function(){return b.Ac(n),b.jc().send()})),b.Xb(19,"ion-list"),b.Xb(20,"ion-item",10),b.Sb(21,"ion-label",11),b.Xb(22,"ion-input",12,13),b.fc("ngModelChange",(function(e){return b.Ac(n),b.jc().recipientAddress=e}))("ngModelChange",(function(){return b.Ac(n),b.jc().recipientChanged()})),b.Wb(),b.Gc(24,T,2,0,"ion-button",14),b.Wb(),b.Xb(25,"ion-item",10),b.Sb(26,"ion-label",15),b.Xb(27,"ion-input",16,17),b.fc("ngModelChange",(function(e){return b.Ac(n),b.jc().quantity=e})),b.Wb(),b.Xb(29,"ion-button",18),b.fc("click",(function(){return b.Ac(n),b.jc().sendAll()})),b.Wb(),b.Wb(),b.Gc(30,M,3,5,"div",19),b.Gc(31,D,1,0,"ion-item",20),b.Sb(32,"br"),b.Xb(33,"ion-item",21),b.Sb(34,"ion-label",22),b.Xb(35,"ion-toggle",23),b.fc("ngModelChange",(function(e){return b.Ac(n),b.jc().showAdvanced=e})),b.Wb(),b.Wb(),b.Gc(36,R,7,10,"div",2),b.Wb(),b.Xb(37,"ion-row"),b.Xb(38,"ion-col"),b.Xb(39,"ion-button",24),b.fc("click",(function(){return b.Ac(n),b.jc().cancel()})),b.Sb(40,"ion-icon",25),b.Sb(41,"span",26),b.Wb(),b.Wb(),b.Xb(42,"ion-col"),b.Xb(43,"ion-button",27),b.Sb(44,"ion-icon",28),b.Sb(45,"span",29),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Wb()}if(2&e){var i=b.jc();b.Fb(4),b.Kc("",b.lc(5,17,"SEND.AVAILABLE_BALANCE"),": "),b.Fb(2),b.pc("ngIf",i.platform.is("mobile")),b.Fb(1),b.pc("ngIf",i.vmAddress&&void 0!==i.vmAddress.balance),b.Fb(1),b.pc("ngIf",!i.vmAddress||null==i.vmAddress.balance),b.Fb(3),b.Kc("",b.lc(12,19,"SEND_SINGLE.FEE"),":"),b.Fb(2),b.pc("ngIf",i.platform.is("mobile")),b.Fb(1),b.Kc(" ",b.mc(15,21,i.gas*i.gasPriceSatoshi,8)," ETP"),b.Fb(2),b.pc("ngIf",i.vmAddress.balance/1e10<i.gas*i.gasPriceSatoshi),b.Fb(4),b.pc("ngClass",b.uc(24,L,!i.validRecipientAddress,i.validRecipientAddress)),b.Fb(2),b.pc("ngModel",i.recipientAddress),b.Fb(2),b.pc("ngIf",i.isMobile),b.Fb(1),b.pc("ngClass",b.uc(27,L,!i.validQuantity(i.quantity),i.validQuantity(i.quantity))),b.Fb(2),b.pc("ngModel",i.quantity),b.Fb(3),b.pc("ngIf",i.tickers&&i.tickers[i.selectedAsset]&&i.tickers[i.selectedAsset][i.base]),b.Fb(1),b.pc("ngIf",i.countDecimals(i.quantity)>i.decimals),b.Fb(4),b.pc("ngModel",i.showAdvanced),b.Fb(1),b.pc("ngIf",i.showAdvanced)}}var O,F,W,X=[{path:":symbol",component:(O=function(){function t(e,i,r,s,a,c,o,u,l){var d=this;n(this,t),this.metaverseService=e,this.walletService=i,this.appService=r,this.router=s,this.alertService=a,this.location=c,this.platform=o,this.vmService=u,this.modalCtrl=l,this.selectedAsset="ETP",this.quantity="",this.message="",this.showAdvanced=!1,this.tickers={},this.vmAddress={},this.validRecipientAddress=!1,this.fiatValue=function(e){return parseFloat(e)*d.tickers[d.selectedAsset][d.base].price||0},this.validQuantity=function(e){return void 0!==e&&d.countDecimals(e)<=d.decimals&&e>0&&d.vmAddress.balance>=Math.round(parseFloat(e)*Math.pow(10,d.decimals))+d.gas*d.gasPriceSatoshi*Math.pow(10,10)},this.validGas=function(e){return void 0!==e&&0===d.countDecimals(e)&&e>=d.appService.default_fees_vm.gas},this.validGasPrice=function(e){return void 0!==e&&0===d.countDecimals(e)&&e>=d.appService.default_fees_vm.gasPrice/Math.pow(10,10)},this.validForm=function(){return d.validQuantity(d.quantity)&&d.validRecipientAddress}}return r(t,[{key:"ngOnInit",value:function(){this.init()}},{key:"init",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectedAsset="ETP",this.quantity="",this.showAdvanced=!1,this.decimals=18,this.recipientAddress="",this.isMobile=this.walletService.isMobile(),this.gas=this.appService.default_fees_vm.gas,this.gasPriceSatoshi=this.appService.default_fees_vm.gasPrice/Math.pow(10,10),this.validRecipientAddress=!1,e.next=3,this.walletService.getVmAddresses();case 3:if(!((t=e.sent)&&t.length&&t[0])){e.next=25;break}return e.t0=!1,e.next=8,this.validAddress(t[0].address);case 8:if(e.t1=e.sent,e.t0!==e.t1){e.next=13;break}this.alertService.showMessage("SWAP.INVALID_VM_ADDRESS.TITLE","SWAP.INVALID_VM_ADDRESS.SUBTITLE",""),this.router.navigate(["account","portfolio"]),e.next=23;break;case 13:return this.vmAddress=t[0],e.next=16,this.vmService.balanceOf(this.vmAddress.address);case 16:return this.vmAddress.balance=e.sent,e.t2=console,e.next=20,this.validAddress(this.vmAddress.address);case 20:e.t3=e.sent,e.t2.log.call(e.t2,e.t3),this.loadTickers();case 23:e.next=26;break;case 25:this.alertService.showMessage("SWAP.NO_VM_ADDRESS.TITLE","SWAP.NO_VM_ADDRESS.SUBTITLE",""),this.router.navigate(["account","identities","generate-vm-address"]);case 26:case"end":return e.stop()}}),e,this)})))}},{key:"loadTickers",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.metaverseService.getBaseAndTickers();case 2:n=t.sent,i=e(n,2),this.base=i[0],this.tickers=i[1];case 6:case"end":return t.stop()}}),t,this)})))}},{key:"countDecimals",value:function(e){return Math.floor(e)!==e&&e.toString().split(".").length>1&&e.toString().split(".")[1].length||0}},{key:"scan",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:d.a,showBackdrop:!1,backdropDismiss:!1});case 2:return(t=e.sent).onWillDismiss().then((function(e){if(e.data&&e.data.text){var i=e.data.text.toString().toString().split("&");n.validAddress(i[0])?(n.recipientAddress=i[0],n.recipientAddressInput.setFocus()):n.alertService.showMessage("SCAN.INVALID_ADDRESS.TITLE","SCAN.INVALID_ADDRESS.SUBTITLE","")}t.remove()})),e.next=6,t.present();case 6:case"end":return e.stop()}}),e,this)})))}},{key:"sendAll",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertService.alertConfirm("SEND_SINGLE.ALL.TITLE","SEND_SINGLE.ALL.SUBTITLE","SEND_SINGLE.ALL.CANCEL","SEND_SINGLE.ALL.OK");case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.quantity=parseFloat(((this.vmAddress.balance-this.gas*this.gasPriceSatoshi*Math.pow(10,10))/Math.pow(10,this.decimals)).toFixed(this.decimals)+"")+"",this.quantityInput.setFocus();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.vmService.sendParams(this.recipientAddress,this.quantity);case 3:t=e.sent,this.alertService.stopLoading(),this.router.navigate(["account","confirm-vm"],{state:{data:{params:t}}}),e.next=17;break;case 7:e.prev=7,e.t0=e.catch(0),e.t1=(console.error(e.t0),this.alertService.stopLoading(),e.t0.message),e.next="ERR_INSUFFICIENT_BALANCE"===e.t1?12:"ERR_TOO_MANY_INPUTS"===e.t1?14:16;break;case 12:return this.alertService.showError("SEND.MESSAGE.INSUFFICIENT_BALANCE",""),e.abrupt("break",17);case 14:return this.alertService.showErrorTranslated("SEND.MESSAGE.ERROR_TOO_MANY_INPUTS","SEND.MESSAGE.ERROR_TOO_MANY_INPUTS_TEXT"),e.abrupt("break",17);case 16:this.alertService.showError("SEND.MESSAGE.CREATE_TRANSACTION",e.t0.message);case 17:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"cancel",value:function(){this.location.back()}},{key:"validAddress",value:function(e){return this.walletService.validWeb3Address(e)}},{key:"recipientChanged",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.recipientAddress&&(this.recipientAddress=this.recipientAddress.trim()),e.next=3,this.validAddress(this.recipientAddress);case 3:this.validRecipientAddress=e.sent;case 4:case"end":return e.stop()}}),e,this)})))}}]),t}(),O.\u0275fac=function(e){return new(e||O)(b.Rb(f.a),b.Rb(p.a),b.Rb(h.a),b.Rb(u.h),b.Rb(v.a),b.Rb(a.i),b.Rb(o.eb),b.Rb(g.a),b.Rb(o.bb))},O.\u0275cmp=b.Lb({type:O,selectors:[["app-send-vm"]],viewQuery:function(e,t){var n;1&e&&(b.Nc(A,!0),b.Nc(E,!0)),2&e&&(b.xc(n=b.gc())&&(t.recipientAddressInput=n.first),b.xc(n=b.gc())&&(t.quantityInput=n.first))},decls:11,vars:6,consts:[["slot","start"],["name","dots",4,"ngIf"],[4,"ngIf"],["name","dots"],[1,"available"],["class","balance-spinner","name","dots",4,"ngIf"],[1,"right"],["align","center","class","wrong-input","translate","SEND.NOTICE_TRANSACTION_FEE_UNCOVERED",4,"ngIf"],[3,"ngSubmit","keyup.enter"],["sendForm","ngForm"],[3,"ngClass"],["color","primary","position","floating","translate","SEND_SINGLE.RECIPIENT_ADDRESS"],["name","recipient_address","required","",3,"ngModel","ngModelChange"],["recipientAddressInput",""],["slot","end","class","scanButton",3,"click",4,"ngIf"],["color","primary","position","floating","translate","SEND_SINGLE.AMOUNT"],["name","quantity","type","number","min","0","required","",3,"ngModel","ngModelChange"],["quantityInput",""],["slot","end","type","button","fill","outline","shape","round","id","sendAll","translate","SEND_SINGLE.BUTTON.SEND_ALL",3,"click"],["class","advice",4,"ngIf"],["lines","none","class","wrong-input","translate","SEND.TOO_MANY_DECIMALS",4,"ngIf"],[1,"toggle-input"],["translate","SEND_SINGLE.SHOW_ADVANCED"],["name","showAdvanced","checked","false",3,"ngModel","ngModelChange"],["color","danger","expand","full","fill","outline","shape","round",3,"click"],["slot","start","name","close"],["translate","SEND_SINGLE.BUTTON.CANCEL"],["type","submit","expand","full","color","primary","fill","outline","shape","round"],["slot","start","disabled","checked","name","cog"],["translate","SEND_SINGLE.BUTTON.NEXT"],["name","dots",1,"balance-spinner"],["align","center","translate","SEND.NOTICE_TRANSACTION_FEE_UNCOVERED",1,"wrong-input"],["slot","end",1,"scanButton",3,"click"],["slot","icon-only","name","qr-code"],[1,"advice"],["lines","none","translate","SEND.TOO_MANY_DECIMALS",1,"wrong-input"],["color","primary","position","floating","translate","SEND_VM.GAS_PRICE"],["name","gasPrice","type","number","min","0","required","",3,"ngModel","ngModelChange"],["color","primary","position","floating","translate","SEND_VM.GAS"],["name","gas","type","number","min","0","required","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(b.Xb(0,"ion-header"),b.Xb(1,"ion-toolbar"),b.Xb(2,"ion-buttons",0),b.Sb(3,"ion-back-button"),b.Wb(),b.Xb(4,"ion-title"),b.Ic(5),b.kc(6,"translate"),b.Wb(),b.Wb(),b.Wb(),b.Xb(7,"ion-content"),b.Sb(8,"br"),b.Gc(9,I,1,0,"ion-spinner",1),b.Gc(10,C,46,30,"div",2),b.Wb()),2&e&&(b.Fb(5),b.Lc("",t.selectedAsset," ",b.lc(6,4,"SEND_VM.TITLE"),""),b.Fb(4),b.pc("ngIf",!t.vmAddress),b.Fb(1),b.pc("ngIf",t.vmAddress&&t.vmAddress.address))},directives:[o.u,o.X,o.j,o.f,o.g,o.V,o.r,a.m,o.R,o.K,o.q,c.p,c.j,c.k,o.A,o.x,a.k,o.z,m.a,o.w,o.hb,c.n,c.i,c.l,o.db,o.i,o.W,o.c,o.v],pipes:[m.d,S.a,a.f],styles:["#sendAll[_ngcontent-%COMP%]{height:34px;margin-top:20px}.balance-spinner[_ngcontent-%COMP%]{margin-left:0;height:15px;top:3px}"]}),O)}],x=((F=function e(){n(this,e)}).\u0275mod=b.Pb({type:F}),F.\u0275inj=b.Ob({factory:function(e){return new(e||F)},imports:[[u.j.forChild(X)],u.j]}),F),P=s("iTUp"),G=((W=function e(){n(this,e)}).\u0275mod=b.Pb({type:W}),W.\u0275inj=b.Ob({factory:function(e){return new(e||W)},imports:[[a.c,c.e,o.Y,m.c.forChild(),P.a,x]]}),W)},iTUp:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("ofXK"),s=i("fXoL"),a=function(){var e=function e(){n(this,e)};return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[r.c]]}),e}()},q5gJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i("fXoL"),a=function(){var e=function(){function e(){n(this,e)}return r(e,[{key:"transform",value:function(e,t){return(e/Math.pow(10,t)).toLocaleString(void 0,{maximumFractionDigits:t})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Qb({name:"format",type:e,pure:!0}),e}()}}])}();