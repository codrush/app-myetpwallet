!function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function e(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{iTUp:function(t,e,o){"use strict";o.d(e,"a",(function(){return c}));var i=o("ofXK"),r=o("fXoL"),c=function(){var t=function t(){n(this,t)};return t.\u0275mod=r.Pb({type:t}),t.\u0275inj=r.Ob({factory:function(e){return new(e||t)},imports:[[i.c]]}),t}()},jUXg:function(t,o,i){"use strict";i.r(o),i.d(o,"VotePageModule",(function(){return C}));var r=i("ofXK"),c=i("3Pt+"),a=i("TEn/"),u=i("tyNb"),s=i("mrSG"),l=i("fXoL"),p=i("BZA/"),b=i("Fvwb"),h=i("sYmb"),f=i("OaWH"),m=i("q5gJ"),d=function(t){return{amount:t}};function v(t,e){if(1&t&&l.Sb(0,"div",12),2&t){var n=l.jc();l.pc("translateParams",l.tc(1,d,n.reward))}}function g(t,e){if(1&t&&l.Sb(0,"ion-progress-bar",14),2&t){var n=l.jc(2);l.pc("value",n.depositProgress(n.output.height,n.output.locked_until))}}function k(t,e){1&t&&l.Sb(0,"ion-progress-bar",14),2&t&&l.pc("value",1)}function w(t,e){if(1&t&&(l.Xb(0,"ion-row"),l.Xb(1,"ion-col"),l.Gc(2,g,1,1,"ion-progress-bar",13),l.Gc(3,k,1,1,"ion-progress-bar",13),l.Wb(),l.Wb()),2&t){var n=l.jc();l.Fb(2),l.pc("ngIf",n.height<=n.output.locked_until&&n.depositProgress(n.output.height,n.output.locked_until)>0),l.Fb(1),l.pc("ngIf",n.height>n.output.locked_until)}}var _,O=function(t){return{delegate:t}},X=function(t){return{block:t}},y=((_=function(){function t(e,o){var i=this;n(this,t),this.appService=e,this.walletService=o,this.explorerURL=function(t){return"mainnet"===i.appService.network?"https://explorer.mvs.org/tx/"+t:"https://explorer-testnet.mvs.org/tx/"+t},this.checkTx=function(){return i.walletService.openLink(i.explorerURL(i.output.hash))},this.current_time=Date.now()}return e(t,[{key:"ngOnInit",value:function(){}},{key:"depositProgress",value:function(t,e){return Math.max(.01,Math.min(.99,Math.round((this.height-t)/(e-t)*100)/100))}}]),t}()).\u0275fac=function(t){return new(t||_)(l.Rb(f.a),l.Rb(b.a))},_.\u0275cmp=l.Lb({type:_,selectors:[["app-vote-item"]],inputs:{output:"output",height:"height",blocktime:"blocktime",icon:"icon",reward:"reward"},decls:36,vars:28,consts:[[1,"manual-copy","display-overflow"],[1,"hash"],["color","primary","fill","clear",1,"tx-link-button",3,"click"],["slot","icon-only","name","open","size","small"],["lines","none",1,"timestamp"],["translate","VOTE.VOTE_FOR_DELEGATE",1,"summaryTxType",3,"translateParams"],[1,"right","summaryAmount"],["class","default-color fee","translate","VOTE.REWARD",3,"translateParams",4,"ngIf"],["translate","VOTE.LOCKED_SINCE_BLOCK",3,"translateParams"],[1,"right"],["translate","VOTE.LOCKED_UNTIL_BLOCK",3,"translateParams"],[4,"ngIf"],["translate","VOTE.REWARD",1,"default-color","fee",3,"translateParams"],[3,"value",4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(l.Xb(0,"ion-card",0),l.Xb(1,"ion-item"),l.Xb(2,"ion-grid"),l.Xb(3,"ion-row"),l.Xb(4,"ion-col"),l.Xb(5,"span",1),l.Ic(6),l.Wb(),l.Xb(7,"ion-button",2),l.fc("click",(function(){return e.checkTx()})),l.Sb(8,"ion-icon",3),l.Wb(),l.Xb(9,"div",4),l.Xb(10,"p"),l.Ic(11),l.kc(12,"date"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(13,"ion-row"),l.Xb(14,"ion-col"),l.Sb(15,"div",5),l.Wb(),l.Xb(16,"ion-col"),l.Xb(17,"div",6),l.Xb(18,"div"),l.Ic(19),l.kc(20,"format"),l.Wb(),l.Gc(21,v,1,3,"div",7),l.Wb(),l.Wb(),l.Wb(),l.Xb(22,"ion-row"),l.Xb(23,"ion-col"),l.Xb(24,"p"),l.Sb(25,"span",8),l.Sb(26,"br"),l.Ic(27),l.kc(28,"date"),l.Wb(),l.Wb(),l.Xb(29,"ion-col",9),l.Xb(30,"p"),l.Sb(31,"span",10),l.Sb(32,"br"),l.Ic(33),l.kc(34,"date"),l.Wb(),l.Wb(),l.Wb(),l.Gc(35,w,4,2,"ion-row",11),l.Wb(),l.Wb(),l.Wb()),2&t&&(l.Fb(6),l.Jc(e.output.hash),l.Fb(5),l.Jc(l.mc(12,10,1e3*e.output.confirmed_at,"medium")),l.Fb(4),l.pc("translateParams",l.tc(22,O,e.output.voteAvatar)),l.Fb(4),l.Kc("",l.mc(20,13,e.output.attenuation_model_param.lock_quantity,e.output.attachment.decimals)," DNA "),l.Fb(2),l.pc("ngIf",e.reward),l.Fb(4),l.pc("translateParams",l.tc(24,X,e.output.height)),l.Fb(2),l.Kc(" (",l.mc(28,16,1e3*e.output.confirmed_at,"medium"),") "),l.Fb(4),l.pc("translateParams",l.tc(26,X,e.output.locked_until)),l.Fb(2),l.Kc(" (~",l.mc(34,19,(e.output.locked_until-e.height)*e.blocktime*1e3+e.current_time,"medium"),")* "),l.Fb(2),l.pc("ngIf",e.output.height<=e.height))},directives:[a.k,a.x,a.t,a.K,a.q,a.i,a.v,h.a,r.m,a.F],pipes:[r.e,m.a],styles:["ion-grid[_ngcontent-%COMP%]{width:100%}.summaryAmount[_ngcontent-%COMP%], .summaryTxType[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-primary)}.summaryAmount[_ngcontent-%COMP%]{float:right;width:100%}.hash[_ngcontent-%COMP%]{margin-top:10px;--min-height:16px}.fee[_ngcontent-%COMP%]{font-size:16px}.summaryTxType[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin:0}.tx-link-button[_ngcontent-%COMP%]{top:40%;transform:translateY(-40%)}.timestamp[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{height:20px;margin-right:8px}.card[_ngcontent-%COMP%]{margin-left:10px;width:calc(100% - 20px)}"]}),_);function W(t,e){if(1&t&&l.Sb(0,"app-vote-item",12),2&t){var n=e.$implicit,o=l.jc(2);l.pc("output",n)("height",o.height)("blocktime",o.blocktime)("reward",o.rewards[n.hash])("icon","assets/icon/DNA.png")}}function T(t,e){if(1&t&&(l.Xb(0,"div"),l.Sb(1,"h2",9),l.Gc(2,W,1,5,"app-vote-item",10),l.Xb(3,"ion-row"),l.Xb(4,"ion-col"),l.Sb(5,"p",11),l.Wb(),l.Wb(),l.Wb()),2&t){var n=l.jc();l.Fb(2),l.pc("ngForOf",n.frozen_outputs_locked)}}function I(t,e){if(1&t&&l.Sb(0,"app-vote-item",12),2&t){var n=e.$implicit,o=l.jc(2);l.pc("output",n)("height",o.height)("blocktime",o.blocktime)("reward",o.rewards[n.hash])("icon","assets/icon/DNA.png")}}function S(t,e){if(1&t&&(l.Xb(0,"div"),l.Sb(1,"h2",13),l.Gc(2,I,1,5,"app-vote-item",10),l.Wb()),2&t){var n=l.jc();l.Fb(2),l.pc("ngForOf",n.frozen_outputs_unlocked)}}var E,P,x,F,R=[{path:":symbol",component:(E=function(){function t(e,o,i){var r=this;n(this,t),this.activatedRoute=e,this.metaverseService=o,this.walletService=i,this.frozen_outputs_locked=[],this.frozen_outputs_unlocked=[],this.availableUtxos={},this.rewards={},this.decimals=4,this.checkElection=function(){return r.walletService.openLink("https://"+r.electionURL())},this.electionURL=function(){return"www.dnavote.com"},this.openLink=function(t){return r.walletService.openLink(t)},this.selectedAsset=this.activatedRoute.snapshot.params.symbol}return e(t,[{key:"ngOnInit",value:function(){}},{key:"ionViewDidEnter",value:function(){var t=this;this.metaverseService.getHeight().then((function(e){return t.height=e,Promise.all([t.getBlocktime(e),t.calculateFrozenOutputs(e)])}))}},{key:"getBlocktime",value:function(t){var e=this;return this.metaverseService.getBlocktime(t).then((function(t){e.blocktime=t})).catch((function(t){console.error(t.message)}))}},{key:"calculateFrozenOutputs",value:function(t){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,o,i,r,c,a,u,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.metaverseService.getFrozenOutputs(this.selectedAsset);case 2:return n=e.sent,e.next=5,this.metaverseService.getTransactionMap();case 5:if(o=e.sent,this.frozen_outputs_locked=[],this.frozen_outputs_unlocked=[],i=[],r=[],n.forEach((function(e){for(var n=o[e.hash],c=0;c<n.outputs.length;c++){var a=n.outputs[c];"message"===a.attachment.type&&/^vote_([a-z0-9]+)\:([A-Za-z0-9-_@\.]+)$/.test(a.attachment.content)&&(e.voteType=/^vote_([a-z0-9]+)\:/.test(a.attachment.content)?a.attachment.content.match(/^vote_([a-z0-9]+)\:/)[1]:"Invalid Type",e.voteAvatar=/\:([A-Za-z0-9-_@\.]+)$/.test(a.attachment.content)?a.attachment.content.match(/\:([A-Za-z0-9-_@\.]+)$/)[1]:"Invalid Avatar")}t>e.locked_until?(s.frozen_outputs_unlocked.push(e),r.push(e.hash)):(s.frozen_outputs_locked.push(e),i.push(e.hash))})),!(i&&i.length>0)){e.next=15;break}return e.next=12,this.walletService.getElectionRewards(i);case 12:e.t0=e.sent,e.next=16;break;case 15:e.t0=void 0;case 16:return c=e.t0,a=c&&c.result?c.result:[],e.next=20,this.walletService.getElectionRewards(r);case 20:u=e.sent,(a=a.concat(u?u.result:[]))&&a.forEach((function(t){s.rewards[t.txid]=t.reward}));case 22:case"end":return e.stop()}}),e,this)})))}}]),t}(),E.\u0275fac=function(t){return new(t||E)(l.Rb(u.a),l.Rb(p.a),l.Rb(b.a))},E.\u0275cmp=l.Lb({type:E,selectors:[["app-vote"]],decls:26,vars:3,consts:[["slot","start"],["defaultHref","/account/mst"],["translate","VOTE.TITLE"],["align","center"],["translate","VOTE.INFORMATION"],[1,"pointer",3,"click"],["translate","VOTE.INFORMATION_BAYVIEW"],["translate","VOTE.INFORMATION_DNA"],[4,"ngIf"],["translate","VOTE.HISTORY_LOCKED",1,"center"],[3,"output","height","blocktime","reward","icon",4,"ngFor","ngForOf"],["align","center","translate","VOTE.UNLOCK_APPROXIMATION_INFORMATION"],[3,"output","height","blocktime","reward","icon"],["translate","VOTE.HISTORY_UNLOCKED",1,"center"]],template:function(t,e){1&t&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-buttons",0),l.Sb(3,"ion-back-button",1),l.Wb(),l.Sb(4,"ion-title",2),l.Wb(),l.Wb(),l.Xb(5,"ion-content"),l.Xb(6,"ion-row"),l.Xb(7,"ion-col"),l.Xb(8,"p",3),l.Sb(9,"span",4),l.Xb(10,"a",5),l.fc("click",(function(){return e.checkElection()})),l.Ic(11),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(12,"ion-row"),l.Xb(13,"ion-col"),l.Xb(14,"p",3),l.Sb(15,"span",6),l.Xb(16,"a",5),l.fc("click",(function(){return e.openLink("https://www.bayviewplatform.com/")})),l.Ic(17,"www.bayviewplatform.com"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(18,"ion-row"),l.Xb(19,"ion-col"),l.Xb(20,"p",3),l.Sb(21,"span",7),l.Xb(22,"a",5),l.fc("click",(function(){return e.openLink("https://mvsdna.com/")})),l.Ic(23,"mvsdna.com"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Gc(24,T,6,1,"div",8),l.Gc(25,S,3,1,"div",8),l.Wb()),2&t&&(l.Fb(11),l.Jc(e.electionURL()),l.Fb(13),l.pc("ngIf",e.frozen_outputs_locked&&e.frozen_outputs_locked.length),l.Fb(1),l.pc("ngIf",e.frozen_outputs_unlocked&&e.frozen_outputs_unlocked.length))},directives:[a.u,a.X,a.j,a.f,a.g,a.V,h.a,a.r,a.K,a.q,r.m,r.l,y],styles:[""]}),E)}],L=((P=function t(){n(this,t)}).\u0275mod=l.Pb({type:P}),P.\u0275inj=l.Ob({factory:function(t){return new(t||P)},imports:[[u.j.forChild(R)],u.j]}),P),A=i("iTUp"),z=((F=function t(){n(this,t)}).\u0275mod=l.Pb({type:F}),F.\u0275inj=l.Ob({factory:function(t){return new(t||F)},imports:[[r.c,c.e,a.Y,h.c.forChild(),A.a]]}),F),C=((x=function t(){n(this,t)}).\u0275mod=l.Pb({type:x}),x.\u0275inj=l.Ob({factory:function(t){return new(t||x)},imports:[[r.c,c.e,a.Y,z,h.c.forChild(),L]]}),x)},q5gJ:function(t,o,i){"use strict";i.d(o,"a",(function(){return c}));var r=i("fXoL"),c=function(){var t=function(){function t(){n(this,t)}return e(t,[{key:"transform",value:function(t,e){return(t/Math.pow(10,e)).toLocaleString(void 0,{maximumFractionDigits:e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=r.Qb({name:"format",type:t,pure:!0}),t}()}}])}();