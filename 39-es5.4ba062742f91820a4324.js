!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(t.push(i.value),!n||t.length!==n);a=!0);}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return t}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function t(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"5El1":function(n,r,o){"use strict";o.r(r),o.d(r,"CreatePageModule",(function(){return W}));var i=o("ofXK"),s=o("3Pt+"),l=o("TEn/"),c=o("tyNb"),b=o("mrSG"),u=o("fXoL"),d=o("3LUQ"),A=o("BZA/"),f=o("sYmb"),g=o("q5gJ");function E(e,n){1&e&&u.Sb(0,"br")}function m(e,n){1&e&&u.Sb(0,"ion-item",34)}function h(e,n){1&e&&u.Sb(0,"ion-item",35)}function v(e,n){if(1&e&&(u.Xb(0,"ion-select-option",38),u.Ic(1),u.kc(2,"format"),u.Wb()),2&e){var t=n.$implicit;u.qc("value",t.address),u.Fb(1),u.Lc(" ",t.address," - ",u.mc(2,3,t.available,8)," ETP")}}function T(e,n){if(1&e){var t=u.Yb();u.Xb(0,"ion-select",36),u.fc("ngModelChange",(function(e){return u.Ac(t),u.jc().avatar_address=e})),u.kc(1,"translate"),u.kc(2,"translate"),u.Gc(3,v,3,6,"ion-select-option",37),u.Wb()}if(2&e){var a=u.jc();u.qc("okText",u.lc(1,5,"OK")),u.qc("cancelText",u.lc(2,7,"CANCEL")),u.pc("ngModel",a.avatar_address)("interfaceOptions",a.addressSelectOptions),u.Fb(3),u.pc("ngForOf",a.addressbalances)}}function p(e,n){1&e&&u.Sb(0,"ion-input",39)}function S(e,n){1&e&&u.Sb(0,"ion-item",40)}function R(e,n){1&e&&(u.Xb(0,"ion-item",41),u.Ic(1),u.kc(2,"translate"),u.Wb()),2&e&&(u.Fb(1),u.Kc("",u.lc(2,1,"MESSAGE_TOO_LONG")," "))}function _(e,n){if(1&e){var t=u.Yb();u.Xb(0,"div"),u.Sb(1,"br"),u.Xb(2,"ion-item",42),u.Sb(3,"ion-label",43),u.Wb(),u.Sb(4,"div",44),u.Xb(5,"ion-item",42),u.Sb(6,"span",45),u.Sb(7,"span",46),u.Wb(),u.Xb(8,"ion-item"),u.Xb(9,"ion-range",47),u.fc("ngModelChange",(function(e){return u.Ac(t),u.jc().bounty_fee=e})),u.Xb(10,"ion-label",48),u.Ic(11),u.Wb(),u.Xb(12,"ion-label",49),u.Ic(13),u.Wb(),u.Wb(),u.Wb(),u.Wb()}if(2&e){var a=u.jc();u.Fb(9),u.pc("ngModel",a.bounty_fee),u.Fb(2),u.Kc("",(100-a.bounty_fee)/100," ETP"),u.Fb(2),u.Kc("",a.bounty_fee/100," ETP")}}var y,C,O,M=function(e){return{"error-border":e}},I=function(e,n){return{"error-border":e,"valid-border":n}},N=function e(n,t){a(this,e),this.address=n,this.available=t},F=[{path:"",component:(y=function(){function n(t,r,o,i,s,l){var c=this;a(this,n),this.alertService=t,this.router=r,this.metaverseService=o,this.platform=i,this.translate=s,this.activatedRoute=l,this.symbol="",this.avatar_address="",this.addressbalances=[],this.message="",this.available_symbol=!1,this.showAdvanced=!1,this.validAddress=function(e){return""!=e},this.validSymbol=function(e){return e.length>2&&e.length<64&&!/[^A-Za-z0-9@_.-]/g.test(e)&&c.available_symbol},this.validMessageLength=function(e){return c.metaverseService.verifyMessageSize(e)<253},this.symbolChanged=function(e){e=e.trim(),c.symbol=e,e&&e.length>=3&&c.metaverseService.getAvatarAvailable(e).then((function(n){c.symbol===e&&(c.available_symbol=n)})).catch((function(e){c.available_symbol=!1}))},this.avatar_address=this.activatedRoute.snapshot.params.address,Promise.all([this.metaverseService.getAddresses(),this.metaverseService.getAddressBalances()]).then((function(n){var t=e(n,2),a=t[0],r=t[1];a.forEach((function(e){r[e]&&r[e].ETP&&r[e].ETP.available>=1e8&&""===r[e].AVATAR&&c.addressbalances.push(new N(e,r[e].ETP.available))}))})),this.bounty_fee=80,this.default_bounty_fee=this.bounty_fee,this.total_fee=1e8,this.metaverseService.getFees().then((function(e){c.bounty_fee=e.bountyShare,c.default_bounty_fee=c.bounty_fee,c.total_fee=e.avatar}))}var r,o,i;return r=n,(o=[{key:"ngOnInit",value:function(){var e=this;this.translate.get("CREATE_AVATAR.ADDRESS_SUBTITLE").subscribe((function(n){e.addressSelectOptions={subHeader:n}}))}},{key:"create",value:function(){var e=this;return this.alertService.showLoading().then((function(){var n=[];return e.message&&n.push(e.message),e.metaverseService.createAvatarTx(e.avatar_address,e.symbol,void 0,e.showAdvanced?e.bounty_fee*e.total_fee/100:e.default_bounty_fee*e.total_fee/100,n)})).catch((function(n){switch(console.error(n),e.alertService.stopLoading(),n.message){case"ERR_CONNECTION":e.alertService.showError("SEND.MESSAGE.ERROR_SEND_TEXT","");break;case"ERR_BROADCAST":e.translate.get("SEND.MESSAGE.ONE_TX_PER_BLOCK").subscribe((function(n){e.alertService.showError("SEND.MESSAGE.BROADCAST_ERROR",n)}));break;case"ERR_DECRYPT_WALLET":e.alertService.showError("MESSAGE.PASSWORD_WRONG","");break;case"ERR_INSUFFICIENT_BALANCE":e.alertService.showError("SEND.MESSAGE.INSUFFICIENT_BALANCE","");break;default:e.alertService.showError("SEND.MESSAGE.CREATE_TRANSACTION",n.message)}}))}},{key:"send",value:function(){var e=this;this.create().then((function(n){var t=n.encode().toString("hex");e.router.navigate(["account","confirm"],{state:{data:{tx:t}}}),e.alertService.stopLoading()}))}},{key:"confirm",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertService.alertConfirm("CREATE_AVATAR.CONFIRMATION.TITLE","CREATE_AVATAR.CONFIRMATION.SUBTITLE","CREATE_AVATAR.CONFIRMATION.CANCEL","CREATE_AVATAR.CONFIRMATION.OK");case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.send();case 5:case"end":return e.stop()}}),e,this)})))}}])&&t(r.prototype,o),i&&t(r,i),n}(),y.\u0275fac=function(e){return new(e||y)(u.Rb(d.a),u.Rb(c.h),u.Rb(A.a),u.Rb(l.eb),u.Rb(f.e),u.Rb(c.a))},y.\u0275cmp=u.Lb({type:y,selectors:[["app-create"]],decls:54,vars:31,consts:[["slot","start"],["defaultHref","/account/identities"],["translate","CREATE_AVATAR.TITLE"],["align","center","translate","CREATE_AVATAR.INFORMATION"],[1,"right"],[4,"ngIf"],[2,"padding-bottom","0",3,"ngSubmit"],["sendForm","ngForm"],[2,"padding-bottom","0"],[3,"ngClass"],["color","primary","position","floating","translate","CREATE_AVATAR.NAME"],["name","symbol","maxlength","63","required","",3,"ngModel","ngModelChange"],["translate","CREATE_AVATAR.HELP.NAME",1,"advice"],["lines","none","class","wrong-input","translate","CREATE_AVATAR.NAME_TOO_SHORT",4,"ngIf"],["lines","none","class","wrong-input","translate","CREATE_AVATAR.AVATAR_ALREADY_EXIST",4,"ngIf"],["color","primary","position","floating","translate","CREATE_AVATAR.ADDRESS"],["name","avatar_address","multiple","false",3,"ngModel","okText","cancelText","interfaceOptions","ngModelChange",4,"ngIf"],["disabled","",4,"ngIf"],["translate","CREATE_AVATAR.HELP.ADDRESS",1,"advice"],["lines","none","class","wrong-input","translate","CREATE_AVATAR.NO_ADDRESS_1ETP",4,"ngIf"],["color","primary","position","floating"],["name","message",3,"ngModel","ngModelChange"],[1,"advice"],["lines","none","class","wrong-input",4,"ngIf"],[1,"toggle-input"],["translate","CREATE_AVATAR.SHOW_ADVANCED"],["name","showAdvanced","checked","false",3,"ngModel","ngModelChange"],[1,"padding-bottom"],["color","danger","expand","full","fill","outline","shape","round","routerLink","/avatar"],["slot","start","name","close"],["translate","CREATE_AVATAR.BUTTON.CANCEL"],["expand","full","type","submit","fill","outline","shape","round","color","primary",3,"disabled"],["slot","start","disabled","checked","name","cog"],["translate","CREATE_AVATAR.BUTTON.NEXT"],["lines","none","translate","CREATE_AVATAR.NAME_TOO_SHORT",1,"wrong-input"],["lines","none","translate","CREATE_AVATAR.AVATAR_ALREADY_EXIST",1,"wrong-input"],["name","avatar_address","multiple","false",3,"ngModel","okText","cancelText","interfaceOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled",""],["lines","none","translate","CREATE_AVATAR.NO_ADDRESS_1ETP",1,"wrong-input"],["lines","none",1,"wrong-input"],["lines","none"],["color","primary","translate","CREATE_AVATAR.BOUNTY_FEE"],["translate","CREATE_AVATAR.HELP.BOUNTY_FEE",1,"advice"],["translate","CREATE_AVATAR.BOUNTY_FEE_MINERS",1,"rangeTextLeft"],["translate","CREATE_AVATAR.BOUNTY_FEE_DEVELOPERS",1,"right"],["min","0","max","80","step","10","snaps","true","color","primary","name","bounty_fee",1,"bountyFeeRange",3,"ngModel","ngModelChange"],["range-left",""],["range-right","",1,"right"]],template:function(e,n){if(1&e&&(u.Xb(0,"ion-header"),u.Xb(1,"ion-toolbar"),u.Xb(2,"ion-buttons",0),u.Sb(3,"ion-back-button",1),u.Wb(),u.Sb(4,"ion-title",2),u.Wb(),u.Wb(),u.Xb(5,"ion-content"),u.Xb(6,"ion-row"),u.Xb(7,"ion-col"),u.Sb(8,"p",3),u.Wb(),u.Wb(),u.Xb(9,"ion-row"),u.Xb(10,"ion-col"),u.Xb(11,"p",4),u.Ic(12),u.kc(13,"translate"),u.Gc(14,E,1,0,"br",5),u.Ic(15," 1 ETP"),u.Wb(),u.Wb(),u.Wb(),u.Xb(16,"form",6,7),u.fc("ngSubmit",(function(){return n.confirm()})),u.Xb(18,"ion-list",8),u.Xb(19,"ion-item",9),u.Sb(20,"ion-label",10),u.Xb(21,"ion-input",11),u.fc("ngModelChange",(function(e){return n.symbol=e}))("ngModelChange",(function(){return n.symbolChanged(n.symbol)})),u.Wb(),u.Wb(),u.Sb(22,"div",12),u.Gc(23,m,1,0,"ion-item",13),u.Gc(24,h,1,0,"ion-item",14),u.Xb(25,"ion-item",9),u.Sb(26,"ion-label",15),u.Gc(27,T,4,9,"ion-select",16),u.Gc(28,p,1,0,"ion-input",17),u.Wb(),u.Sb(29,"div",18),u.Gc(30,S,1,0,"ion-item",19),u.Xb(31,"ion-item",9),u.Xb(32,"ion-label",20),u.Ic(33),u.kc(34,"translate"),u.Wb(),u.Xb(35,"ion-input",21),u.fc("ngModelChange",(function(e){return n.message=e})),u.Wb(),u.Wb(),u.Xb(36,"div",22),u.Ic(37),u.kc(38,"translate"),u.Wb(),u.Gc(39,R,3,3,"ion-item",23),u.Sb(40,"br"),u.Xb(41,"ion-item",24),u.Sb(42,"ion-label",25),u.Xb(43,"ion-toggle",26),u.fc("ngModelChange",(function(e){return n.showAdvanced=e})),u.Wb(),u.Wb(),u.Gc(44,_,14,3,"div",5),u.Wb(),u.Xb(45,"ion-row",27),u.Xb(46,"ion-col"),u.Xb(47,"ion-button",28),u.Sb(48,"ion-icon",29),u.Sb(49,"span",30),u.Wb(),u.Wb(),u.Xb(50,"ion-col"),u.Xb(51,"ion-button",31),u.Sb(52,"ion-icon",32),u.Sb(53,"span",33),u.Wb(),u.Wb(),u.Wb(),u.Wb(),u.Wb()),2&e){var t=u.yc(17);u.Fb(12),u.Kc("",u.lc(13,18,"FEE"),":"),u.Fb(2),u.pc("ngIf",n.platform.is("mobile")),u.Fb(5),u.pc("ngClass",u.tc(24,M,!n.validSymbol(n.symbol))),u.Fb(2),u.pc("ngModel",n.symbol),u.Fb(2),u.pc("ngIf",n.symbol.length>0&&n.symbol.length<3),u.Fb(1),u.pc("ngIf",n.symbol.length>=3&&!n.available_symbol),u.Fb(1),u.pc("ngClass",u.tc(26,M,!n.validAddress(n.avatar_address))),u.Fb(2),u.pc("ngIf",0!=n.addressbalances.length),u.Fb(1),u.pc("ngIf",0==n.addressbalances.length),u.Fb(2),u.pc("ngIf",0==n.addressbalances.length),u.Fb(1),u.pc("ngClass",u.uc(28,I,!n.validMessageLength(n.message),n.message.length>0&&n.validMessageLength(n.message))),u.Fb(2),u.Jc(u.lc(34,20,"CREATE_AVATAR.MESSAGE")),u.Fb(2),u.pc("ngModel",n.message),u.Fb(2),u.Jc(u.lc(38,22,"CREATE_AVATAR.HELP.MESSAGE")),u.Fb(2),u.pc("ngIf",!n.validMessageLength(n.message)),u.Fb(4),u.pc("ngModel",n.showAdvanced),u.Fb(1),u.pc("ngIf",n.showAdvanced),u.Fb(7),u.pc("disabled",!(t.form.valid&&n.validSymbol(n.symbol)&&n.validAddress(n.avatar_address)&&n.validMessageLength(n.message)))}},directives:[l.u,l.X,l.j,l.f,l.g,l.V,f.a,l.r,l.K,l.q,i.m,s.p,s.j,s.k,l.A,l.x,i.k,l.z,l.w,l.hb,s.f,s.n,s.i,s.l,l.W,l.c,l.i,l.fb,c.i,l.v,l.N,l.gb,i.l,l.O,l.G],pipes:[f.d,g.a],styles:[".uppercase[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-transform:uppercase}.bountyFeeRange[_ngcontent-%COMP%]   .range-slider[_ngcontent-%COMP%]{margin-right:20%}.bountyFeeRange.range-md[_ngcontent-%COMP%]   .range-bar[_ngcontent-%COMP%]:not(.range-bar-active){width:calc(125% + 25px)}.rangeTextLeft[_ngcontent-%COMP%]{padding:8px}"]}),y)}],w=((C=function e(){a(this,e)}).\u0275mod=u.Pb({type:C}),C.\u0275inj=u.Ob({factory:function(e){return new(e||C)},imports:[[c.j.forChild(F)],c.j]}),C),X=o("iTUp"),W=((O=function e(){a(this,e)}).\u0275mod=u.Pb({type:O}),O.\u0275inj=u.Ob({factory:function(e){return new(e||O)},imports:[[i.c,s.e,l.Y,f.c.forChild(),X.a,w]]}),O)}}])}();