(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{iVTo:function(e,t,n){"use strict";n.r(t),n.d(t,"GenerateAddressPageModule",(function(){return w}));var i=n("ofXK"),s=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),o=n("mrSG"),l=n("fXoL"),c=n("BZA/"),d=n("Fvwb"),b=n("OaWH"),S=n("3LUQ"),p=n("sYmb");const u=function(e){return{max_addresses:e}};function E(e,t){if(1&e&&l.Sb(0,"ion-item",21),2&e){const e=l.jc(2);l.pc("translateParams",l.tc(1,u,e.appService.max_addresses))}}const h=function(e){return{"error-border":e}};function g(e,t){if(1&e){const e=l.Yb();l.Xb(0,"ion-item",8),l.Sb(1,"ion-label",22),l.Xb(2,"ion-input",23),l.fc("ngModelChange",(function(t){return l.Ac(e),l.jc(2).passphrase=t})),l.Wb(),l.Wb()}if(2&e){const e=l.jc(2);l.pc("ngClass",l.tc(2,h,!e.validPassword(e.passphrase))),l.Fb(2),l.pc("ngModel",e.passphrase)}}const R=function(e,t){return{"error-border":e,"valid-border":t}};function m(e,t){if(1&e){const e=l.Yb();l.Xb(0,"form",6,7),l.fc("ngSubmit",(function(){return l.Ac(e),l.jc().setIndex()})),l.Xb(2,"ion-list"),l.Xb(3,"ion-item",8),l.Sb(4,"ion-label",9),l.Xb(5,"ion-input",10),l.fc("ngModelChange",(function(t){return l.Ac(e),l.jc().index=t})),l.Wb(),l.Wb(),l.Sb(6,"div",11),l.Gc(7,E,1,3,"ion-item",12),l.Gc(8,g,3,4,"ion-item",13),l.Sb(9,"br"),l.Wb(),l.Xb(10,"ion-row"),l.Xb(11,"ion-col",14),l.Xb(12,"ion-button",15),l.fc("click",(function(){return l.Ac(e),l.jc().cancel()})),l.Sb(13,"ion-icon",16),l.Sb(14,"span",17),l.Wb(),l.Wb(),l.Xb(15,"ion-col",14),l.Xb(16,"ion-button",18),l.Sb(17,"ion-icon",19),l.Sb(18,"span",20),l.Wb(),l.Wb(),l.Wb(),l.Wb()}if(2&e){const e=l.yc(1),t=l.jc();l.Fb(3),l.pc("ngClass",l.uc(6,R,!t.validIndex(t.index),t.validIndex(t.index))),l.Fb(2),l.pc("ngModel",t.index),l.Fb(1),l.pc("translateParams",l.tc(9,u,t.appService.max_addresses)),l.Fb(1),l.pc("ngIf",t.index>t.appService.max_addresses),l.Fb(1),l.pc("ngIf",!t.walletFromXpub),l.Fb(8),l.pc("disabled",!e.form.valid||!t.validIndex(t.index)||!t.walletFromXpub&&!t.validPassword(t.passphrase))}}function v(e,t){1&e&&l.Sb(0,"ion-spinner")}const f=[{path:"",component:(()=>{class e{constructor(e,t,n,i,s){this.metaverseService=e,this.walletService=t,this.appService=n,this.alertService=i,this.navCtrl=s,this.loading=!0,this.validIndex=e=>e>=2&&e<=this.appService.max_addresses,this.validPassword=e=>!!e&&e.length>3}ngOnInit(){}ionViewDidEnter(){return Object(o.a)(this,void 0,void 0,(function*(){this.index=(yield this.walletService.getAddressIndex())||10;const e=yield this.walletService.getXpub();e&&(this.walletFromXpub=yield this.walletService.getWalletFromMasterPublicKey(e)),this.loading=!1}))}cancel(){this.navCtrl.navigateBack("/account/identities")}setIndex(){return Object(o.a)(this,void 0,void 0,(function*(){this.walletFromXpub?this.setIndexFromXpub():this.setIndexFromWallet()}))}setIndexFromWallet(){return Object(o.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading();const e=yield this.walletService.getWallet(this.passphrase),t=yield this.walletService.generateAddresses(e,0,this.index);yield this.metaverseService.setAddresses(t);const n=yield this.walletService.getMasterPublicKey(this.passphrase);yield this.walletService.setXpub(n),this.alertService.stopLoading(),this.navCtrl.navigateRoot("/loading",{state:{data:{reset:!0}}})}catch(e){switch(console.error(e),this.alertService.stopLoading(),e.message){case"ERR_DECRYPT_WALLET":this.alertService.showError("MESSAGE.PASSWORD_WRONG","");break;default:this.alertService.showError("GENERATE_ADDRESSES.ERROR.UNKOWN_ERROR",e.message)}}}))}setIndexFromXpub(){return Object(o.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading();const e=yield this.walletService.generateAddresses(this.walletFromXpub,0,this.index);yield this.metaverseService.setAddresses(e),this.alertService.stopLoading(),this.navCtrl.navigateRoot("/loading",{state:{data:{reset:!0}}})}catch(e){switch(console.error(e),this.alertService.stopLoading(),e.message){case"ERR_DECRYPT_WALLET":this.alertService.showError("MESSAGE.PASSWORD_WRONG","");break;default:this.alertService.showError("GENERATE_ADDRESSES.ERROR.UNKOWN_ERROR",e.message)}}}))}}return e.\u0275fac=function(t){return new(t||e)(l.Rb(c.a),l.Rb(d.a),l.Rb(b.a),l.Rb(S.a),l.Rb(r.cb))},e.\u0275cmp=l.Lb({type:e,selectors:[["app-generate-address"]],decls:13,vars:2,consts:[["slot","start"],["defaultHref","/account/identities"],["translate","GENERATE_ADDRESS.TITLE"],["align","center","translate","GENERATE_ADDRESS.EXPLANATION"],[3,"ngSubmit",4,"ngIf","ngIfElse"],["loadingSpinner",""],[3,"ngSubmit"],["sendForm","ngForm"],[3,"ngClass"],["color","primary","position","floating","translate","GENERATE_ADDRESS.TOTAL_NUMBER_OF_ADDRESSES"],["name","symbol","type","number","required","",3,"ngModel","ngModelChange"],["lines","none","translate","GENERATE_ADDRESS.HELP.NUMBER",1,"advice",3,"translateParams"],["lines","none","class","wrong-input","translate","GENERATE_ADDRESS.ERROR.TOO_MANY_ADDRESSES",3,"translateParams",4,"ngIf"],[3,"ngClass",4,"ngIf"],["size","12","size-sm","6"],["color","danger","fill","outline","shape","round","expand","full",3,"click"],["slot","start","name","close"],["translate","GENERATE_ADDRESS.BUTTON.CANCEL"],["expand","full","fill","outline","shape","round","type","submit","color","primary",3,"disabled"],["slot","start","name","send"],["translate","GENERATE_ADDRESS.BUTTON.CHANGE_ADDRESS_NUMBER"],["lines","none","translate","GENERATE_ADDRESS.ERROR.TOO_MANY_ADDRESSES",1,"wrong-input",3,"translateParams"],["color","primary","position","floating","translate","GLOBAL.PASSWORD"],["name","passphrase","type","password","required","",3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(l.Xb(0,"ion-header"),l.Xb(1,"ion-toolbar"),l.Xb(2,"ion-buttons",0),l.Sb(3,"ion-back-button",1),l.Wb(),l.Sb(4,"ion-title",2),l.Wb(),l.Wb(),l.Xb(5,"ion-content"),l.Xb(6,"ion-grid"),l.Xb(7,"ion-row"),l.Xb(8,"ion-col"),l.Sb(9,"p",3),l.Wb(),l.Wb(),l.Gc(10,m,19,11,"form",4),l.Gc(11,v,1,0,"ng-template",null,5,l.Hc),l.Wb(),l.Wb()),2&e){const e=l.yc(12);l.Fb(10),l.pc("ngIf",!t.loading)("ngIfElse",e)}},directives:[r.u,r.X,r.j,r.f,r.g,r.V,p.a,r.r,r.t,r.K,r.q,i.m,s.p,s.j,s.k,r.A,r.x,i.k,r.z,r.w,r.db,s.n,s.i,s.l,r.i,r.v,r.hb,r.R],styles:[""]}),e})()}];let A=(()=>{class e{}return e.\u0275mod=l.Pb({type:e}),e.\u0275inj=l.Ob({factory:function(t){return new(t||e)},imports:[[a.j.forChild(f)],a.j]}),e})(),w=(()=>{class e{}return e.\u0275mod=l.Pb({type:e}),e.\u0275inj=l.Ob({factory:function(t){return new(t||e)},imports:[[i.c,s.e,r.Y,p.c.forChild(),A]]}),e})()}}]);