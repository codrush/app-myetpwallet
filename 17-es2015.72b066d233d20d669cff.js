(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{iTUp:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("ofXK"),a=s("fXoL");let i=(()=>{class e{}return e.\u0275mod=a.Pb({type:e}),e.\u0275inj=a.Ob({factory:function(t){return new(t||e)},imports:[[n.c]]}),e})()},q5gJ:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("fXoL");let a=(()=>{class e{transform(e,t){return(e/Math.pow(10,t)).toLocaleString(void 0,{maximumFractionDigits:t})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Qb({name:"format",type:e,pure:!0}),e})()},qe8w:function(e,t,s){"use strict";s.r(t),s.d(t,"BurnPageModule",(function(){return X}));var n=s("ofXK"),a=s("3Pt+"),i=s("TEn/"),c=s("tyNb"),o=s("mrSG"),r=s("fXoL"),l=s("BZA/"),d=s("OaWH"),b=s("3LUQ"),h=s("sYmb"),u=s("q5gJ");function g(e,t){1&e&&r.Sb(0,"p",32)}function f(e,t){1&e&&r.Sb(0,"br")}function m(e,t){1&e&&r.Sb(0,"br")}function S(e,t){if(1&e&&(r.Xb(0,"ion-select-option",36),r.Ic(1),r.Wb()),2&e){const e=r.jc().$implicit;r.qc("value",e),r.Fb(1),r.Kc("",e," ")}}function p(e,t){if(1&e&&(r.Vb(0),r.Gc(1,S,2,2,"ion-select-option",35),r.Ub()),2&e){const e=t.$implicit,s=r.jc(2);r.Fb(1),r.pc("ngIf",s.balances[e].available>0&&"ETP"!=e)}}function E(e,t){if(1&e){const e=r.Yb();r.Xb(0,"ion-select",33),r.fc("ngModelChange",(function(t){return r.Ac(e),r.jc().selectedAsset=t}))("ngModelChange",(function(t){return r.Ac(e),r.jc().onSelectedAssetChange(t)})),r.kc(1,"translate"),r.kc(2,"translate"),r.Xb(3,"ion-select-option",34),r.Ic(4,"ETP"),r.Wb(),r.Gc(5,p,2,1,"ng-container",21),r.Wb()}if(2&e){const e=r.jc();r.qc("okText",r.lc(1,4,"OK")),r.qc("cancelText",r.lc(2,6,"CANCEL")),r.pc("ngModel",e.selectedAsset),r.Fb(5),r.pc("ngForOf",e.assetsList)}}function A(e,t){if(1&e&&(r.Xb(0,"div",37),r.Ic(1),r.kc(2,"number"),r.Wb()),2&e){const e=r.jc();r.Fb(1),r.Lc(" \u2248",e.base," ",r.mc(2,2,e.fiatValue(e.quantity),"1.0-2")," ")}}function v(e,t){1&e&&r.Sb(0,"ion-item",38)}function N(e,t){if(1&e&&(r.Xb(0,"ion-select-option",36),r.Ic(1),r.kc(2,"format"),r.Wb()),2&e){const e=r.jc().$implicit,t=r.jc();r.qc("value",e.address),r.Fb(1),r.Mc(" ",e.identifier," - ",r.mc(2,4,e.balance,t.decimals)," ",t.selectedAsset,"")}}function F(e,t){if(1&e&&(r.Vb(0),r.Gc(1,N,3,7,"ion-select-option",35),r.Ub()),2&e){const e=t.$implicit;r.Fb(1),r.pc("ngIf",e.balance>0)}}function T(e,t){1&e&&r.Sb(0,"ion-item",39)}function O(e,t){1&e&&r.Sb(0,"ion-item",54)}function M(e,t){if(1&e&&(r.Xb(0,"ion-select-option",36),r.Ic(1),r.kc(2,"format"),r.Wb()),2&e){const e=t.$implicit,s=r.jc(2);r.qc("value",e.address),r.Fb(1),r.Mc(" ",e.identifier," - ",r.mc(2,4,e.balance,s.decimals)," ",s.selectedAsset,"")}}const I=function(e,t){return{"error-border":e,"valid-border":t}};function C(e,t){if(1&e){const e=r.Yb();r.Xb(0,"div"),r.Xb(1,"ion-item",40),r.Sb(2,"ion-label",41),r.Xb(3,"ion-badge",42),r.Ic(4),r.kc(5,"format"),r.Wb(),r.Wb(),r.Xb(6,"ion-item"),r.Xb(7,"ion-range",43),r.fc("ngModelChange",(function(t){return r.Ac(e),r.jc().fee=t})),r.Xb(8,"ion-label",44),r.Ic(9),r.kc(10,"format"),r.Wb(),r.Xb(11,"ion-label",45),r.Ic(12),r.kc(13,"format"),r.Wb(),r.Wb(),r.Wb(),r.Xb(14,"ion-item",12),r.Sb(15,"ion-label",46),r.Xb(16,"ion-input",47),r.fc("ngModelChange",(function(t){return r.Ac(e),r.jc().message=t})),r.Wb(),r.Wb(),r.Sb(17,"div",48),r.Gc(18,O,1,0,"ion-item",49),r.Sb(19,"br"),r.Xb(20,"ion-item"),r.Sb(21,"ion-label",50),r.Xb(22,"ion-select",51),r.fc("ngModelChange",(function(t){return r.Ac(e),r.jc().changeAddress=t})),r.kc(23,"translate"),r.kc(24,"translate"),r.Sb(25,"ion-select-option",52),r.Gc(26,M,3,7,"ion-select-option",53),r.Wb(),r.Wb(),r.Wb()}if(2&e){const e=r.jc();r.Fb(4),r.Kc("",r.mc(5,11,e.fee,8)," ETP"),r.Fb(3),r.pc("ngModel",e.fee),r.Fb(2),r.Jc(r.mc(10,14,1e4,8)),r.Fb(3),r.Jc(r.mc(13,17,1e7,8)),r.Fb(2),r.pc("ngClass",r.uc(24,I,!e.validMessageLength(e.message),e.message.length>0&&e.validMessageLength(e.message))),r.Fb(2),r.pc("ngModel",e.message),r.Fb(2),r.pc("ngIf",!e.validMessageLength(e.message)),r.Fb(4),r.qc("okText",r.lc(23,20,"OK")),r.qc("cancelText",r.lc(24,22,"CANCEL")),r.pc("ngModel",e.changeAddress),r.Fb(4),r.pc("ngForOf",e.addressbalances)}}const _=function(e){return{"error-border":e}},L=[{path:"",component:(()=>{class e{constructor(e,t,s,n,a,i,c){this.metaverseService=e,this.appService=t,this.activatedRoute=s,this.router=n,this.alertService=a,this.location=i,this.platform=c,this.balances={},this.quantity="",this.sendFrom="auto",this.feeAddress="auto",this.message="",this.showAdvanced=!1,this.addressbalancesObject={},this.tickers={},this.fiatValue=e=>parseFloat(e)*this.tickers[this.selectedAsset][this.base].price||0,this.validQuantity=e=>void 0!==e&&this.countDecimals(e)<=this.decimals&&e>0&&("ETP"===this.selectedAsset&&this.showBalance>=Math.round(parseFloat(e)*Math.pow(10,this.decimals))+this.fee||"ETP"!==this.selectedAsset&&this.showBalance>=parseFloat(e)*Math.pow(10,this.decimals)),this.validFromAddress=e=>"auto"===e||this.addressbalancesObject[e]&&0!==this.addressbalancesObject[e].ETP.available,this.validMessageLength=e=>this.metaverseService.verifyMessageSize(e)<253,this.validForm=()=>this.validQuantity(this.quantity)&&this.validMessageLength(this.message)&&this.validFromAddress(this.sendFrom)}ngOnInit(){this.selectedAsset=this.activatedRoute.snapshot.params.symbol||"ETP",Promise.all([this.metaverseService.getBalances(),this.metaverseService.getAddresses(),this.metaverseService.getAddressBalances()]).then(([e,t,s])=>{this.balances=e.MST;const n="ETP"===this.selectedAsset?e.ETP:e.MST[this.selectedAsset];this.balance=n&&n.available?n.available:0,this.etpBalance=e.ETP.available,this.showBalance=this.balance,this.decimals=n.decimals,this.assetsList=Object.keys(this.balances),this.assetsList.sort((e,t)=>e.localeCompare(t)),this.addresses=t,this.addressbalancesObject=s,this.updateBalancePerAddress()}),this.fee=this.appService.default_fees.default,this.defaultFee=this.fee,this.metaverseService.getFees().then(e=>{this.fee=e.default,this.defaultFee=this.fee})}updateBalancePerAddress(){const e=[];Object.keys(this.addresses).forEach(t=>{const s=this.addresses[t];e.push(this.addressbalancesObject[s]?{address:s,avatar:this.addressbalancesObject[s].AVATAR?this.addressbalancesObject[s].AVATAR:"",identifier:this.addressbalancesObject[s].AVATAR?this.addressbalancesObject[s].AVATAR:s,balance:"ETP"===this.selectedAsset?this.addressbalancesObject[s].ETP.available:this.addressbalancesObject[s].MST[this.selectedAsset]?this.addressbalancesObject[s].MST[this.selectedAsset].available:0}:{address:s,avatar:"",identifier:s,balance:0})}),this.addressbalances=e,"auto"!==this.sendFrom&&(!this.addressbalancesObject[this.sendFrom][this.selectedAsset]||this.addressbalancesObject[this.sendFrom][this.selectedAsset].available<Math.round(parseFloat(this.quantity)*Math.pow(10,this.decimals)))&&(this.sendFrom="auto")}ionViewDidEnter(){return Object(o.a)(this,void 0,void 0,(function*(){const e=yield this.metaverseService.getAddresses();Array.isArray(e)&&e.length?this.loadTickers():this.router.navigate(["login"])}))}loadTickers(){return Object(o.a)(this,void 0,void 0,(function*(){[this.base,this.tickers]=yield this.metaverseService.getBaseAndTickers()}))}countDecimals(e){return Math.floor(e)!==e&&e.toString().split(".").length>1&&e.toString().split(".")[1].length||0}confirm(){return Object(o.a)(this,void 0,void 0,(function*(){(yield this.alertService.alertConfirm("BURN.CONFIRMATION.TITLE","BURN.CONFIRMATION.SUBTITLE","BURN.CONFIRMATION.CANCEL","BURN.CONFIRMATION.OK"))&&this.send()}))}create(){return this.alertService.showLoading().then(()=>{const e=[];return this.message&&e.push(this.message),this.metaverseService.burn(this.selectedAsset,Math.round(parseFloat(this.quantity)*Math.pow(10,this.decimals)),"auto"!==this.sendFrom?this.sendFrom:null,this.showAdvanced&&"auto"!==this.changeAddress?this.changeAddress:void 0,this.showAdvanced?this.fee:this.defaultFee,this.showAdvanced&&e!==[]?e:void 0)}).catch(e=>{throw console.error(e.message),this.alertService.stopLoading(),Error(e)})}send(){return Object(o.a)(this,void 0,void 0,(function*(){try{const e=(yield this.create()).encode().toString("hex");this.router.navigate(["account","confirm"],{state:{data:{tx:e}}}),this.alertService.stopLoading()}catch(e){switch(console.error(e),this.alertService.stopLoading(),e.message){case"ERR_INSUFFICIENT_BALANCE":this.alertService.showError("SEND.MESSAGE.INSUFFICIENT_BALANCE","");break;case"ERR_TOO_MANY_INPUTS":this.alertService.showErrorTranslated("SEND.MESSAGE.ERROR_TOO_MANY_INPUTS","SEND.MESSAGE.ERROR_TOO_MANY_INPUTS_TEXT");break;default:this.alertService.showError("SEND.MESSAGE.CREATE_TRANSACTION",e.message)}}}))}onSelectedAssetChange(e){this.decimals=this.balances[this.selectedAsset].decimals,this.updateBalancePerAddress()}cancel(){this.location.back()}onFromAddressChange(){"auto"===this.sendFrom?this.showBalance=this.balance:this.addressbalances.length&&this.addressbalances.forEach(e=>{e.address===this.sendFrom&&(this.showBalance=e.balance)})}}return e.\u0275fac=function(t){return new(t||e)(r.Rb(l.a),r.Rb(d.a),r.Rb(c.a),r.Rb(c.h),r.Rb(b.a),r.Rb(n.i),r.Rb(i.eb))},e.\u0275cmp=r.Lb({type:e,selectors:[["app-burn"]],decls:58,vars:41,consts:[["slot","start"],["defaultHref","/account/advanced"],["translate","BURN.TITLE"],["align","center","class","wrong-input","translate","SEND.NOTICE_TRANSACTION_FEE_UNCOVERED",4,"ngIf"],[1,"available"],[4,"ngIf"],[1,"right"],[3,"ngSubmit","keyup.enter"],["sendForm","ngForm"],[1,"valid-border"],["color","primary","position","floating","translate","BURN.SELECT_ASSET"],["name","selectedAsset","multiple","false",3,"ngModel","okText","cancelText","ngModelChange",4,"ngIf"],[3,"ngClass"],["color","primary","position","floating","translate","SEND_SINGLE.AMOUNT"],["name","quantity","type","number","min","0","required","",3,"ngModel","ngModelChange"],["quantityInput",""],["class","advice",4,"ngIf"],["lines","none","class","wrong-input","translate","SEND.TOO_MANY_DECIMALS",4,"ngIf"],["translate","SEND_SINGLE.SEND_FROM"],["name","sendfrom","multiple","false",3,"ngModel","okText","cancelText","ngModelChange"],["selected","true","value","auto","translate","SEND_SINGLE.SEND_FROM_AUTO"],[4,"ngFor","ngForOf"],["lines","none","class","wrong-input","translate","SEND_SINGLE.FROM_ADDRESS_NO_ETP",4,"ngIf"],[1,"toggle-input"],["translate","SEND_SINGLE.SHOW_ADVANCED"],["name","showAdvanced","checked","false",3,"ngModel","ngModelChange"],["color","danger","expand","full","fill","outline","shape","round",3,"click"],["slot","start","name","close"],["translate","SEND_SINGLE.BUTTON.CANCEL"],["type","submit","expand","full","color","primary","fill","outline","shape","round",3,"disabled"],["slot","start","disabled","checked","name","cog"],["translate","SEND_SINGLE.BUTTON.NEXT"],["align","center","translate","SEND.NOTICE_TRANSACTION_FEE_UNCOVERED",1,"wrong-input"],["name","selectedAsset","multiple","false",3,"ngModel","okText","cancelText","ngModelChange"],["selected","true","value","ETP"],[3,"value",4,"ngIf"],[3,"value"],[1,"advice"],["lines","none","translate","SEND.TOO_MANY_DECIMALS",1,"wrong-input"],["lines","none","translate","SEND_SINGLE.FROM_ADDRESS_NO_ETP",1,"wrong-input"],["lines","none"],["color","primary","translate","SEND_SINGLE.FEE"],["item-end","","color","primary"],["min","10000","max","10000000","step","10000","color","primary","name","fee",3,"ngModel","ngModelChange"],["range-left",""],["range-right",""],["position","floating","translate","SEND_SINGLE.MESSAGE"],["name","message",3,"ngModel","ngModelChange"],["translate","SEND_SINGLE.HELP.MESSAGE",1,"advice"],["lines","none","class","wrong-input","translate","SEND_SINGLE.MESSAGE_TOO_LONG",4,"ngIf"],["translate","SEND_SINGLE.CHANGE_ADDRESS"],["name","changeaddress",3,"ngModel","okText","cancelText","ngModelChange"],["selected","true","value","auto","translate","SEND_SINGLE.CHANGE_ADDRESS_AUTO"],[3,"value",4,"ngFor","ngForOf"],["lines","none","translate","SEND_SINGLE.MESSAGE_TOO_LONG",1,"wrong-input"]],template:function(e,t){1&e&&(r.Xb(0,"ion-header"),r.Xb(1,"ion-toolbar"),r.Xb(2,"ion-buttons",0),r.Sb(3,"ion-back-button",1),r.Wb(),r.Sb(4,"ion-title",2),r.Wb(),r.Wb(),r.Xb(5,"ion-content"),r.Sb(6,"br"),r.Gc(7,g,1,0,"p",3),r.Xb(8,"ion-row"),r.Xb(9,"ion-col"),r.Xb(10,"p",4),r.Ic(11),r.kc(12,"translate"),r.Gc(13,f,1,0,"br",5),r.Ic(14),r.kc(15,"format"),r.Wb(),r.Wb(),r.Xb(16,"ion-col"),r.Xb(17,"p",6),r.Ic(18),r.kc(19,"translate"),r.Gc(20,m,1,0,"br",5),r.Ic(21),r.kc(22,"format"),r.Wb(),r.Wb(),r.Wb(),r.Xb(23,"form",7,8),r.fc("ngSubmit",(function(){return t.send()}))("keyup.enter",(function(){return t.send()})),r.Xb(25,"ion-list"),r.Xb(26,"ion-item",9),r.Sb(27,"ion-label",10),r.Gc(28,E,6,8,"ion-select",11),r.Wb(),r.Xb(29,"ion-item",12),r.Sb(30,"ion-label",13),r.Xb(31,"ion-input",14,15),r.fc("ngModelChange",(function(e){return t.quantity=e})),r.Wb(),r.Wb(),r.Gc(33,A,3,5,"div",16),r.Gc(34,v,1,0,"ion-item",17),r.Sb(35,"br"),r.Xb(36,"ion-item",12),r.Sb(37,"ion-label",18),r.Xb(38,"ion-select",19),r.fc("ngModelChange",(function(e){return t.sendFrom=e}))("ngModelChange",(function(){return t.onFromAddressChange()})),r.kc(39,"translate"),r.kc(40,"translate"),r.Sb(41,"ion-select-option",20),r.Gc(42,F,2,1,"ng-container",21),r.Wb(),r.Wb(),r.Gc(43,T,1,0,"ion-item",22),r.Sb(44,"br"),r.Xb(45,"ion-item",23),r.Sb(46,"ion-label",24),r.Xb(47,"ion-toggle",25),r.fc("ngModelChange",(function(e){return t.showAdvanced=e})),r.Wb(),r.Wb(),r.Gc(48,C,27,27,"div",5),r.Wb(),r.Xb(49,"ion-row"),r.Xb(50,"ion-col"),r.Xb(51,"ion-button",26),r.fc("click",(function(){return t.cancel()})),r.Sb(52,"ion-icon",27),r.Sb(53,"span",28),r.Wb(),r.Wb(),r.Xb(54,"ion-col"),r.Xb(55,"ion-button",29),r.Sb(56,"ion-icon",30),r.Sb(57,"span",31),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Fb(7),r.pc("ngIf",t.etpBalance<t.fee/1e8),r.Fb(4),r.Kc("",r.lc(12,22,"SEND.AVAILABLE_BALANCE"),": "),r.Fb(2),r.pc("ngIf",t.platform.is("mobile")),r.Fb(1),r.Lc("",r.mc(15,24,t.showBalance,t.decimals)," ",t.selectedAsset,""),r.Fb(4),r.Kc("",r.lc(19,27,"SEND_SINGLE.FEE"),":"),r.Fb(2),r.pc("ngIf",t.platform.is("mobile")),r.Fb(1),r.Kc(" ",r.mc(22,29,t.fee,8)," ETP"),r.Fb(7),r.pc("ngIf",t.balances),r.Fb(1),r.pc("ngClass",r.uc(36,I,!t.validQuantity(t.quantity),t.validQuantity(t.quantity))),r.Fb(2),r.pc("ngModel",t.quantity),r.Fb(2),r.pc("ngIf",t.tickers&&t.tickers[t.selectedAsset]&&t.tickers[t.selectedAsset][t.base]),r.Fb(1),r.pc("ngIf",t.countDecimals(t.quantity)>t.decimals),r.Fb(2),r.pc("ngClass",r.tc(39,_,!t.validFromAddress(t.sendFrom))),r.Fb(2),r.qc("okText",r.lc(39,32,"OK")),r.qc("cancelText",r.lc(40,34,"CANCEL")),r.pc("ngModel",t.sendFrom),r.Fb(4),r.pc("ngForOf",t.addressbalances),r.Fb(1),r.pc("ngIf",!t.validFromAddress(t.sendFrom)),r.Fb(4),r.pc("ngModel",t.showAdvanced),r.Fb(1),r.pc("ngIf",t.showAdvanced),r.Fb(7),r.pc("disabled",!t.validForm()))},directives:[i.u,i.X,i.j,i.f,i.g,i.V,h.a,i.r,n.m,i.K,i.q,a.p,a.j,a.k,i.A,i.x,i.z,n.k,i.w,i.db,a.n,a.i,a.l,i.N,i.gb,i.O,n.l,i.W,i.c,i.i,i.v,i.h,i.G,i.hb],pipes:[h.d,u.a,n.f],styles:[""]}),e})()}];let w=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(t){return new(t||e)},imports:[[c.j.forChild(L)],c.j]}),e})();var k=s("iTUp");let X=(()=>{class e{}return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(t){return new(t||e)},imports:[[n.c,a.e,i.Y,h.c.forChild(),k.a,w]]}),e})()}}]);