!function(){function t(e,n){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,n)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=r(t);if(e){var o=r(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return n(this,i)}}function n(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{dwd6:function(n,r,a){"use strict";a.r(r),a.d(r,"LoadingPageModule",(function(){return N}));var s=a("ofXK"),c=a("3Pt+"),u=a("TEn/"),l=a("tyNb"),h=a("mrSG"),p=a("lJxs"),f=a("7o/Q"),b=a("D0XW");a("l7GE"),a("ZUHj");var g={leading:!0,trailing:!1},d=function(){function t(e,n,r,a){i(this,t),this.duration=e,this.scheduler=n,this.leading=r,this.trailing=a}return o(t,[{key:"call",value:function(t,e){return e.subscribe(new v(t,this.duration,this.scheduler,this.leading,this.trailing))}}]),t}(),v=function(n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(a,n);var r=e(a);function a(t,e,n,o,s){var c;return i(this,a),(c=r.call(this,t)).duration=e,c.scheduler=n,c.leading=o,c.trailing=s,c._hasTrailingValue=!1,c._trailingValue=null,c}return o(a,[{key:"_next",value:function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(m,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}},{key:"_complete",value:function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}},{key:"clearThrottle",value:function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}]),a}(f.a);function m(t){t.subscriber.clearThrottle()}var y=a("fXoL"),O=a("BZA/"),w=a("sYmb"),x=a("OaWH");function R(t,e){1&t&&y.Sb(0,"div",13)}var T=function(t){return{height:t}};function S(t,e){if(1&t&&(y.Sb(0,"h4",14),y.kc(1,"async")),2&t){var n=y.jc();y.pc("translateParams",y.tc(3,T,y.lc(1,1,n.metaverseService.lastTxHeight$)))}}function k(t,e){1&t&&y.Sb(0,"h4",15)}function _(t,e){1&t&&y.Sb(0,"p",16)}function I(t,e){if(1&t){var n=y.Yb();y.Xb(0,"ion-row",17),y.Xb(1,"ion-col"),y.Xb(2,"ion-button",18),y.fc("click",(function(){return y.Ac(n),y.jc().cancel()})),y.Sb(3,"ion-icon",19),y.Sb(4,"span",20),y.Wb(),y.Wb(),y.Xb(5,"ion-col"),y.Xb(6,"ion-button",21),y.fc("click",(function(){return y.Ac(n),y.jc().updateBalances()})),y.Sb(7,"ion-icon",22),y.Sb(8,"span",23),y.Wb(),y.Wb(),y.Wb()}}var P,D,j,E=[{path:"",component:(P=function(){function t(e,n,r,a,o){var s=this;i(this,t),this.metaverseService=e,this.translate=n,this.platform=r,this.appService=a,this.router=o,this.loadingHeight=0,this.reset=!1,this.showRestartOption=!1,this.progress$=this.metaverseService.lastTxHeight$.pipe(Object(p.a)((function(t){return s.calcProgress(t,s.maxHeight,s.firstTxHeight)})),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;return function(r){return r.lift(new d(t,e,n.leading,n.trailing))}}(300)),this.reset=history.state.data&&history.state.data.reset}return o(t,[{key:"ngOnInit",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.reset,t.t0){t.next=5;break}return t.next=4,this.metaverseService.getDbUpdateNeeded();case 4:t.t0=t.sent;case 5:if(t.t1=t.t0,!t.t1){t.next=11;break}return t.next=9,this.metaverseService.dataReset();case 9:return t.next=11,this.metaverseService.setDbVersion(this.appService.db_version);case 11:return t.next=13,this.updateBalances();case 13:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnDestroy",value:function(){this.lastTxHeightSubscription&&this.lastTxHeightSubscription.unsubscribe()}},{key:"updateBalances",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showRestartOption=!1,t.prev=1,t.next=4,this.metaverseService.updateHeight();case 4:return this.maxHeight=t.sent,t.next=7,this.metaverseService.getData();case 7:return t.next=9,this.metaverseService.setUpdateTime();case 9:setTimeout((function(){return e.router.navigate(["/account","portfolio"],{replaceUrl:!0})}),1e3),t.next=20;break;case 12:t.prev=12,t.t0=t.catch(1),t.t1=(console.error(t.t0),t.t0.message),t.next="ERR_NO_ADDRESS"===t.t1?17:19;break;case 17:return this.router.navigate(["login"]),t.abrupt("break",20);case 19:this.showRestartOption=!0;case 20:case"end":return t.stop()}}),t,this,[[1,12]])})))}},{key:"calcProgress",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t&&e?Math.max(1,Math.min(99,Math.round((t-n)/(e-n)*100))):0}},{key:"cancel",value:function(){return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.metaverseService.hardReset();case 2:this.router.navigate(["/"]);case 3:case"end":return t.stop()}}),t,this)})))}}]),t}(),P.\u0275fac=function(t){return new(t||P)(y.Rb(O.a),y.Rb(w.e),y.Rb(u.eb),y.Rb(x.a),y.Rb(l.h))},P.\u0275cmp=y.Lb({type:P,selectors:[["app-loading"]],decls:21,vars:15,consts:[[1,"center"],["size-md","12","size-lg","6","offset-lg","3"],[1,"top-message"],["translate","LOADING.TITLE"],[1,"logo-row"],[1,"logo"],[1,"banner"],["class","mini-loader",4,"ngIf"],["color","primary",3,"value"],["translate","LOADING.CURRENT_HEIGHT",3,"translateParams",4,"ngIf"],["class","valid-input","translate","LOADING.COMPLETE",4,"ngIf"],["class","wrong-input","translate","LOADING.STOPPED",4,"ngIf"],["class","padding-bottom",4,"ngIf"],[1,"mini-loader"],["translate","LOADING.CURRENT_HEIGHT",3,"translateParams"],["translate","LOADING.COMPLETE",1,"valid-input"],["translate","LOADING.STOPPED",1,"wrong-input"],[1,"padding-bottom"],["color","danger","fill","outline","shape","round",3,"click"],["slot","start","name","close"],["translate","LOADING.BUTTON.BACK"],["type","submit","fill","outline","shape","round","color","primary",3,"click"],["slot","start","name","sync"],["translate","LOADING.BUTTON.RETRY"]],template:function(t,e){1&t&&(y.Xb(0,"ion-content",0),y.Xb(1,"ion-grid"),y.Xb(2,"ion-row"),y.Xb(3,"ion-col",1),y.Xb(4,"ion-row",2),y.Xb(5,"ion-col"),y.Sb(6,"h1",3),y.Wb(),y.Wb(),y.Xb(7,"ion-row",4),y.Xb(8,"ion-col",5),y.Sb(9,"div",6),y.Wb(),y.Wb(),y.Gc(10,R,1,0,"div",7),y.Ic(11),y.kc(12,"async"),y.Sb(13,"ion-progress-bar",8),y.kc(14,"async"),y.Gc(15,S,2,5,"h4",9),y.kc(16,"async"),y.Gc(17,k,1,0,"h4",10),y.kc(18,"async"),y.Gc(19,_,1,0,"p",11),y.Gc(20,I,9,0,"ion-row",12),y.Wb(),y.Wb(),y.Wb(),y.Wb()),2&t&&(y.Fb(10),y.pc("ngIf",!e.showRestartOption),y.Fb(1),y.Kc(" ",y.lc(12,7,e.progress$),"% "),y.Fb(2),y.pc("value",y.lc(14,9,e.progress$)/100),y.Fb(2),y.pc("ngIf",100!=y.lc(16,11,e.progress$)),y.Fb(2),y.pc("ngIf",100==y.lc(18,13,e.progress$)),y.Fb(2),y.pc("ngIf",e.showRestartOption),y.Fb(1),y.pc("ngIf",e.showRestartOption))},directives:[u.r,u.t,u.K,u.q,w.a,s.m,u.F,u.i,u.v],pipes:[s.b],styles:[".logo-row[_ngcontent-%COMP%]{min-height:120px;padding-top:50px;padding-bottom:20px}.logo[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.banner[_ngcontent-%COMP%]{margin:10px auto;background:url(/assets/logo.png) no-repeat;width:100%;max-width:240px;height:100px;outline:0;background-size:100%}"]}),P)}],G=((j=function t(){i(this,t)}).\u0275mod=y.Pb({type:j}),j.\u0275inj=y.Ob({factory:function(t){return new(t||j)},imports:[[l.j.forChild(E)],l.j]}),j),N=((D=function t(){i(this,t)}).\u0275mod=y.Pb({type:D}),D.\u0275inj=y.Ob({factory:function(t){return new(t||D)},imports:[[s.c,c.e,w.c.forChild(),u.Y,G]]}),D)}}])}();