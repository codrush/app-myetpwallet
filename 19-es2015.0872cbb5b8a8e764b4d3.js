(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{grBA:function(t,e,n){"use strict";n.r(e),n.d(e,"ConfirmVmPageModule",(function(){return F}));var o=n("ofXK"),r=n("3Pt+"),s=n("TEn/"),i=n("tyNb"),a=n("mrSG"),c=n("fXoL"),l=n("BZA/"),d=n("Fvwb"),b=n("3LUQ"),h=n("m5Kd"),m=n("sYmb"),p=n("R0Ic"),u=n("OaWH"),g=n("q5gJ");function f(t,e){1&t&&c.Sb(0,"ion-spinner",2)}function O(t,e){if(1&t&&(c.Xb(0,"div",17),c.Ic(1),c.kc(2,"format"),c.Wb()),2&t){const t=c.jc(3);c.Fb(1),c.Kc(" -",c.mc(2,1,t.params.value,18)," ETP ")}}function T(t,e){if(1&t&&(c.Xb(0,"div",18),c.Ic(1),c.kc(2,"format"),c.Wb()),2&t){const t=c.jc(3);c.Fb(1),c.Kc(" +",c.mc(2,1,t.params.value,18)," ETP ")}}function v(t,e){if(1&t&&(c.Xb(0,"div"),c.Ic(1),c.kc(2,"format"),c.Sb(3,"div",19),c.Wb()),2&t){const t=c.jc(3);c.Fb(1),c.Kc(" ",c.mc(2,1,t.params.value,18)," ETP ")}}function S(t,e){if(1&t&&(c.Xb(0,"div",14),c.Gc(1,O,3,4,"div",15),c.Gc(2,T,3,4,"div",16),c.Gc(3,v,4,4,"div",1),c.Wb()),2&t){const t=c.jc(2);c.Fb(1),c.pc("ngIf",t.myAddress(t.from)&&!t.myAddress(t.params.to)),c.Fb(1),c.pc("ngIf",!t.myAddress(t.from)&&t.myAddress(t.params.to)),c.Fb(1),c.pc("ngIf",t.myAddress(t.from)&&t.myAddress(t.params.to))}}function R(t,e){if(1&t&&(c.Xb(0,"div",20),c.Ic(1),c.kc(2,"translate"),c.kc(3,"format"),c.Wb()),2&t){const t=c.jc(2);c.Fb(1),c.Lc(" ",c.lc(2,2,"TX.TX_FEE"),": ",c.mc(3,4,t.txFee,8)," ETP ")}}const E=function(t){return{personal:t}};function _(t,e){if(1&t&&(c.Xb(0,"ion-card"),c.Xb(1,"ion-item",3),c.Xb(2,"ion-grid"),c.Xb(3,"ion-row"),c.Xb(4,"ion-col"),c.Sb(5,"h1",4),c.Wb(),c.Wb(),c.Xb(6,"ion-row"),c.Xb(7,"ion-col"),c.Xb(8,"ion-row"),c.Xb(9,"ion-col",5),c.Xb(10,"div",6),c.Xb(11,"div"),c.Ic(12),c.kc(13,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(14,"ion-col",7),c.Gc(15,S,4,3,"div",8),c.Sb(16,"br"),c.Gc(17,R,4,7,"div",9),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Xb(18,"ion-row"),c.Xb(19,"ion-col",5),c.Xb(20,"ion-row"),c.Sb(21,"ion-col",10),c.Wb(),c.Xb(22,"ion-row",11),c.Xb(23,"ion-col"),c.Ic(24),c.Wb(),c.Wb(),c.Wb(),c.Xb(25,"ion-col",12),c.Xb(26,"ion-row"),c.Sb(27,"ion-col",13),c.Wb(),c.Xb(28,"ion-row",11),c.Xb(29,"ion-col"),c.Ic(30),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&t){const t=c.jc();c.Fb(12),c.Jc(c.lc(13,7,"TX.TX_TYPE."+t.txType)),c.Fb(3),c.pc("ngIf","VM_ETP"==t.txType),c.Fb(2),c.pc("ngIf",t.txFee),c.Fb(5),c.pc("ngClass",c.tc(9,E,t.myAddress(t.from))),c.Fb(2),c.Kc(" ",t.from," "),c.Fb(4),c.pc("ngClass",c.tc(11,E,t.myAddress(t.params.to))),c.Fb(2),c.Kc(" ",t.params.to," ")}}let C=(()=>{class t{constructor(t,e,n){this.appService=t,this.walletService=e,this.translate=n,this.decimalsMst={},this.totalInputs={ETP:0,MST:{}},this.totalOutputs={ETP:0,MST:{}},this.totalPersonalInputs={ETP:0,MST:{}},this.totalPersonalOutputs={ETP:0,MST:{}},this.txFee=0,this.txType="VM_ETP",this.checkTx=()=>console.log("TODO"),this.explorerURL=t=>"mainnet"===this.appService.network?"https://explorer.mvs.org/tx/"+t:"https://explorer-testnet.mvs.org/tx/"+t,console.log(this.params)}ngOnChanges(t){}myAddress(t){return this.addresses.indexOf(t)>-1}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(u.a),c.Rb(d.a),c.Rb(m.e))},t.\u0275cmp=c.Lb({type:t,selectors:[["tx-item-vm"]],inputs:{params:"params",status:"status",addresses:"addresses",height:"height",from:"from"},features:[c.Db],decls:2,vars:2,consts:[["name","dots",4,"ngIf"],[4,"ngIf"],["name","dots"],["button","","lines","none",1,"manual-copy","display-overflow"],["translate","TX.TX_SUMMARY"],["size","12","size-sm","6"],[1,"summaryTxType"],["size","12","size-sm","6",1,"summaryAmount"],["class","right",4,"ngIf"],["class","fee right",4,"ngIf"],["translate","TX_VM.FROM"],[3,"ngClass"],["size","12","size-sm","6",1,"right"],["translate","TX_VM.TO"],[1,"right"],["class","sendAmount",4,"ngIf"],["class","receiveAmount",4,"ngIf"],[1,"sendAmount"],[1,"receiveAmount"],["translate","TX.INTRAWALLET"],[1,"fee","right"]],template:function(t,e){1&t&&(c.Gc(0,f,1,0,"ion-spinner",0),c.Gc(1,_,31,13,"ion-card",1)),2&t&&(c.pc("ngIf",!e.params),c.Fb(1),c.pc("ngIf",e.params))},directives:[o.m,s.R,s.k,s.x,s.t,s.K,s.q,m.a,o.k],pipes:[m.d,g.a],styles:[".hash[_ngcontent-%COMP%]{margin-top:10px;--min-height:16px}.hash[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.timestamp[_ngcontent-%COMP%]{margin:0;--min-height:16px}.summaryTxType[_ngcontent-%COMP%]{font-size:20px}.summaryAmount[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:20px;float:right;--min-height:20px}.sendAmount[_ngcontent-%COMP%]{color:var(--ion-color-danger)!important}.receiveAmount[_ngcontent-%COMP%]{color:#32db64!important}.hash[_ngcontent-%COMP%]{overflow:hidden;word-break:break-all;text-overflow:ellipsis;overflow-wrap:break-word}.fee[_ngcontent-%COMP%]{font-size:16px!important;color:var(--ion-color-dark)!important}.unsigned[_ngcontent-%COMP%]{color:var(--ion-color-primary)}textarea[_ngcontent-%COMP%]{width:100%;border:0!important;resize:none;font-size:1.8rem;margin:20px}.hash[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding-bottom:0}.hash[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.hash[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{padding-top:10px}.hash[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{top:-10px}.tx-hash[_ngcontent-%COMP%]{width:calc(100% - 45px);display:inline-block}.card[_ngcontent-%COMP%]{margin-left:10px;width:calc(100% - 20px)}.show-more-btn[_ngcontent-%COMP%]{margin-left:20px}ion-grid[_ngcontent-%COMP%]{width:100%}.tx-link-button[_ngcontent-%COMP%]{top:40%;transform:translateY(-40%)}.personal[_ngcontent-%COMP%]{font-weight:700}"],data:{animation:[Object(p.i)("expandCollapse",[Object(p.h)("* => void",[Object(p.g)({height:"*"}),Object(p.e)(500,Object(p.g)({height:"0"}))])])]}}),t})();const M=function(t){return{"error-border":t}};function I(t,e){if(1&t){const t=c.Yb();c.Xb(0,"ion-item",13),c.Sb(1,"ion-label",14),c.Xb(2,"ion-input",15),c.fc("ngModelChange",(function(e){return c.Ac(t),c.jc().passphrase=e})),c.Wb(),c.Wb()}if(2&t){const t=c.jc();c.pc("ngClass",c.tc(2,M,!t.validPassword(t.passphrase))),c.Fb(2),c.pc("ngModel",t.passphrase)}}const w=function(t){return[t]},A=[{path:"",component:(()=>{class t{constructor(t,e,n,o,r){this.mvs=t,this.router=e,this.walletService=n,this.alertService=o,this.vmService=r,this.passphrase="",this.showAdvanced=!1,this.vmAddress={},this.validPassword=t=>t.length>0}ngOnInit(){}ionViewDidEnter(){return Object(a.a)(this,void 0,void 0,(function*(){if(this.params=history.state.data?history.state.data.params:void 0,void 0===this.params)this.router.navigate(["account","portfolio"]);else{const t=yield this.walletService.getVmAddresses();this.vmAddress=t[0]||{}}}))}cancel(){this.router.navigate(["account","portfolio"])}home(t){this.router.navigate(["account","portfolio"])}send(){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading();const t=yield this.sign();yield this.broadcast(t)}catch(t){}}))}broadcastOnly(t){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading(),yield this.broadcast(t)}catch(e){}}))}broadcast(t){return Object(a.a)(this,void 0,void 0,(function*(){try{const e=yield this.mvs.send(t);this.alertService.stopLoading(),this.router.navigate(["account","portfolio"]),this.alertService.showMessage("CONFIRM.CONFIRM_ALERT.TITLE","CONFIRM.CONFIRM_ALERT.SUBTITLE",e.hash,"CONFIRM.CONFIRM_ALERT.OK")}catch(e){switch(this.alertService.stopLoading(),console.error(e.message),e.message){case"ERR_CONNECTION":this.alertService.showError("CONFIRM.MESSAGE.ERROR_SEND_TEXT","");break;case"ERR_SIGN_TX":break;default:throw this.alertService.showError("CONFIRM.MESSAGE.BROADCAST_TRANSACTION",e.message),Error("ERR_BROADCAST_TX")}}}))}sign(){return Object(a.a)(this,void 0,void 0,(function*(){try{return this.signedTx=yield this.vmService.sign(this.params,this.passphrase),this.hexTx=this.signedTx.rawTransaction,this.signedTx}catch(t){switch(console.error(t.message),this.alertService.stopLoading(),t.message){case"ERR_DECRYPT_WALLET":case"ERR_DECRYPT_WALLET_FROM_SEED":throw this.alertService.showError("CONFIRM.MESSAGE.PASSWORD_WRONG",""),Error("ERR_SIGN_TX");case"ERR_INSUFFICIENT_BALANCE":throw this.alertService.showError("CONFIRM.MESSAGE.INSUFFICIENT_BALANCE",""),Error("ERR_SIGN_TX");case"ERR_TOO_MANY_INPUTS":throw this.alertService.showErrorTranslated("CONFIRM.MESSAGE.ERROR_TOO_MANY_INPUTS","CONFIRM.MESSAGE.ERROR_TOO_MANY_INPUTS_TEXT"),Error("ERR_SIGN_TX");default:throw this.alertService.showError("CONFIRM.MESSAGE.SIGN_TRANSACTION",t.message),Error("ERR_SIGN_TX")}}}))}submit(){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.alertService.showLoading();const t=yield this.sign();yield this.vmService.send(t),this.alertService.stopLoading(),this.router.navigate(["account","portfolio"]),this.alertService.showMessage("CONFIRM.CONFIRM_ALERT.TITLE","CONFIRM.CONFIRM_ALERT.SUBTITLE","","CONFIRM.CONFIRM_ALERT.OK")}catch(t){switch(this.alertService.stopLoading(),console.error(t.message),t.message){case"ERR_CONNECTION":this.alertService.showError("CONFIRM.MESSAGE.ERROR_SEND_TEXT","");break;case"ERR_SIGN_TX":break;default:throw this.alertService.showError("CONFIRM.MESSAGE.BROADCAST_TRANSACTION",t.message),Error("ERR_BROADCAST_TX")}}}))}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(l.a),c.Rb(i.h),c.Rb(d.a),c.Rb(b.a),c.Rb(h.a))},t.\u0275cmp=c.Lb({type:t,selectors:[["app-confirm"]],decls:20,vars:8,consts:[["slot","start"],["defaultHref","/account/portfolio"],["translate","CONFIRM.TITLE"],[3,"ngSubmit"],["signTxForm","ngForm"],[3,"params","status","from","addresses"],[3,"ngClass",4,"ngIf"],["color","danger","fill","outline","shape","round","expand","full",3,"click"],["slot","start","name","close"],["translate","CONFIRM.BUTTON.CANCEL"],["type","submit","expand","full","fill","outline","shape","round","color","primary",3,"disabled"],["slot","start","name","send"],["translate","CONFIRM.BUTTON.SIGN_AND_SEND"],[3,"ngClass"],["color","primary","position","floating","translate","CONFIRM.PASSWORD"],["name","passphrase","type","password","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t&&(c.Xb(0,"ion-header"),c.Xb(1,"ion-toolbar"),c.Xb(2,"ion-buttons",0),c.Sb(3,"ion-back-button",1),c.Wb(),c.Sb(4,"ion-title",2),c.Wb(),c.Wb(),c.Xb(5,"ion-content"),c.Xb(6,"form",3,4),c.fc("ngSubmit",(function(){return e.submit()})),c.Sb(8,"tx-item-vm",5),c.Gc(9,I,3,4,"ion-item",6),c.Sb(10,"br"),c.Xb(11,"ion-row"),c.Xb(12,"ion-col"),c.Xb(13,"ion-button",7),c.fc("click",(function(){return e.cancel()})),c.Sb(14,"ion-icon",8),c.Sb(15,"span",9),c.Wb(),c.Wb(),c.Xb(16,"ion-col"),c.Xb(17,"ion-button",10),c.Sb(18,"ion-icon",11),c.Sb(19,"span",12),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb()),2&t){const t=c.yc(7);c.Fb(8),c.pc("params",e.params)("status","UNSIGNED")("from",e.vmAddress.address)("addresses",c.tc(6,w,e.vmAddress.address)),c.Fb(1),c.pc("ngIf",!e.signedTx),c.Fb(8),c.pc("disabled",!t.form.valid||!e.validPassword(e.passphrase))}},directives:[s.u,s.X,s.j,s.f,s.g,s.V,m.a,s.r,r.p,r.j,r.k,C,o.m,s.K,s.q,s.i,s.v,s.x,o.k,s.z,s.w,s.hb,r.n,r.i,r.l],styles:[""]}),t})()}];let N=(()=>{class t{}return t.\u0275mod=c.Pb({type:t}),t.\u0275inj=c.Ob({factory:function(e){return new(e||t)},imports:[[i.j.forChild(A)],i.j]}),t})();var X=n("iTUp");let y=(()=>{class t{}return t.\u0275mod=c.Pb({type:t}),t.\u0275inj=c.Ob({factory:function(e){return new(e||t)},imports:[[o.c,s.Y,m.c.forChild(),i.j,X.a]]}),t})(),F=(()=>{class t{}return t.\u0275mod=c.Pb({type:t}),t.\u0275inj=c.Ob({factory:function(e){return new(e||t)},imports:[[o.c,r.e,s.Y,m.c.forChild(),X.a,y,N]]}),t})()},iTUp:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("ofXK"),r=n("fXoL");let s=(()=>{class t{}return t.\u0275mod=r.Pb({type:t}),t.\u0275inj=r.Ob({factory:function(e){return new(e||t)},imports:[[o.c]]}),t})()},q5gJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n("fXoL");let r=(()=>{class t{transform(t,e){return(t/Math.pow(10,e)).toLocaleString(void 0,{maximumFractionDigits:e})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Qb({name:"format",type:t,pure:!0}),t})()}}]);