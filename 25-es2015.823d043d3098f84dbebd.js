(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{iTUp:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n("ofXK"),i=n("fXoL");let c=(()=>{class t{}return t.\u0275mod=i.Pb({type:t}),t.\u0275inj=i.Ob({factory:function(e){return new(e||t)},imports:[[o.c]]}),t})()},jUXg:function(t,e,n){"use strict";n.r(e),n.d(e,"VotePageModule",(function(){return P}));var o=n("ofXK"),i=n("3Pt+"),c=n("TEn/"),r=n("tyNb"),a=n("mrSG"),s=n("fXoL"),u=n("BZA/"),l=n("Fvwb"),p=n("sYmb"),b=n("OaWH"),h=n("q5gJ");const m=function(t){return{amount:t}};function d(t,e){if(1&t&&s.Sb(0,"div",12),2&t){const t=s.jc();s.pc("translateParams",s.tc(1,m,t.reward))}}function f(t,e){if(1&t&&s.Sb(0,"ion-progress-bar",14),2&t){const t=s.jc(2);s.pc("value",t.depositProgress(t.output.height,t.output.locked_until))}}function g(t,e){1&t&&s.Sb(0,"ion-progress-bar",14),2&t&&s.pc("value",1)}function v(t,e){if(1&t&&(s.Xb(0,"ion-row"),s.Xb(1,"ion-col"),s.Gc(2,f,1,1,"ion-progress-bar",13),s.Gc(3,g,1,1,"ion-progress-bar",13),s.Wb(),s.Wb()),2&t){const t=s.jc();s.Fb(2),s.pc("ngIf",t.height<=t.output.locked_until&&t.depositProgress(t.output.height,t.output.locked_until)>0),s.Fb(1),s.pc("ngIf",t.height>t.output.locked_until)}}const _=function(t){return{delegate:t}},w=function(t){return{block:t}};let k=(()=>{class t{constructor(t,e){this.appService=t,this.walletService=e,this.explorerURL=t=>"mainnet"===this.appService.network?"https://explorer.mvs.org/tx/"+t:"https://explorer-testnet.mvs.org/tx/"+t,this.checkTx=()=>this.walletService.openLink(this.explorerURL(this.output.hash)),this.current_time=Date.now()}ngOnInit(){}depositProgress(t,e){return Math.max(.01,Math.min(.99,Math.round((this.height-t)/(e-t)*100)/100))}}return t.\u0275fac=function(e){return new(e||t)(s.Rb(b.a),s.Rb(l.a))},t.\u0275cmp=s.Lb({type:t,selectors:[["app-vote-item"]],inputs:{output:"output",height:"height",blocktime:"blocktime",icon:"icon",reward:"reward"},decls:36,vars:28,consts:[[1,"manual-copy","display-overflow"],[1,"hash"],["color","primary","fill","clear",1,"tx-link-button",3,"click"],["slot","icon-only","name","open","size","small"],["lines","none",1,"timestamp"],["translate","VOTE.VOTE_FOR_DELEGATE",1,"summaryTxType",3,"translateParams"],[1,"right","summaryAmount"],["class","default-color fee","translate","VOTE.REWARD",3,"translateParams",4,"ngIf"],["translate","VOTE.LOCKED_SINCE_BLOCK",3,"translateParams"],[1,"right"],["translate","VOTE.LOCKED_UNTIL_BLOCK",3,"translateParams"],[4,"ngIf"],["translate","VOTE.REWARD",1,"default-color","fee",3,"translateParams"],[3,"value",4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(s.Xb(0,"ion-card",0),s.Xb(1,"ion-item"),s.Xb(2,"ion-grid"),s.Xb(3,"ion-row"),s.Xb(4,"ion-col"),s.Xb(5,"span",1),s.Ic(6),s.Wb(),s.Xb(7,"ion-button",2),s.fc("click",(function(){return e.checkTx()})),s.Sb(8,"ion-icon",3),s.Wb(),s.Xb(9,"div",4),s.Xb(10,"p"),s.Ic(11),s.kc(12,"date"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(13,"ion-row"),s.Xb(14,"ion-col"),s.Sb(15,"div",5),s.Wb(),s.Xb(16,"ion-col"),s.Xb(17,"div",6),s.Xb(18,"div"),s.Ic(19),s.kc(20,"format"),s.Wb(),s.Gc(21,d,1,3,"div",7),s.Wb(),s.Wb(),s.Wb(),s.Xb(22,"ion-row"),s.Xb(23,"ion-col"),s.Xb(24,"p"),s.Sb(25,"span",8),s.Sb(26,"br"),s.Ic(27),s.kc(28,"date"),s.Wb(),s.Wb(),s.Xb(29,"ion-col",9),s.Xb(30,"p"),s.Sb(31,"span",10),s.Sb(32,"br"),s.Ic(33),s.kc(34,"date"),s.Wb(),s.Wb(),s.Wb(),s.Gc(35,v,4,2,"ion-row",11),s.Wb(),s.Wb(),s.Wb()),2&t&&(s.Fb(6),s.Jc(e.output.hash),s.Fb(5),s.Jc(s.mc(12,10,1e3*e.output.confirmed_at,"medium")),s.Fb(4),s.pc("translateParams",s.tc(22,_,e.output.voteAvatar)),s.Fb(4),s.Kc("",s.mc(20,13,e.output.attenuation_model_param.lock_quantity,e.output.attachment.decimals)," DNA "),s.Fb(2),s.pc("ngIf",e.reward),s.Fb(4),s.pc("translateParams",s.tc(24,w,e.output.height)),s.Fb(2),s.Kc(" (",s.mc(28,16,1e3*e.output.confirmed_at,"medium"),") "),s.Fb(4),s.pc("translateParams",s.tc(26,w,e.output.locked_until)),s.Fb(2),s.Kc(" (~",s.mc(34,19,(e.output.locked_until-e.height)*e.blocktime*1e3+e.current_time,"medium"),")* "),s.Fb(2),s.pc("ngIf",e.output.height<=e.height))},directives:[c.k,c.x,c.t,c.K,c.q,c.i,c.v,p.a,o.m,c.F],pipes:[o.e,h.a],styles:["ion-grid[_ngcontent-%COMP%]{width:100%}.summaryAmount[_ngcontent-%COMP%], .summaryTxType[_ngcontent-%COMP%]{font-size:20px;color:var(--ion-color-primary)}.summaryAmount[_ngcontent-%COMP%]{float:right;width:100%}.hash[_ngcontent-%COMP%]{margin-top:10px;--min-height:16px}.fee[_ngcontent-%COMP%]{font-size:16px}.summaryTxType[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin:0}.tx-link-button[_ngcontent-%COMP%]{top:40%;transform:translateY(-40%)}.timestamp[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{height:20px;margin-right:8px}.card[_ngcontent-%COMP%]{margin-left:10px;width:calc(100% - 20px)}"]}),t})();function O(t,e){if(1&t&&s.Sb(0,"app-vote-item",12),2&t){const t=e.$implicit,n=s.jc(2);s.pc("output",t)("height",n.height)("blocktime",n.blocktime)("reward",n.rewards[t.hash])("icon","assets/icon/DNA.png")}}function X(t,e){if(1&t&&(s.Xb(0,"div"),s.Sb(1,"h2",9),s.Gc(2,O,1,5,"app-vote-item",10),s.Xb(3,"ion-row"),s.Xb(4,"ion-col"),s.Sb(5,"p",11),s.Wb(),s.Wb(),s.Wb()),2&t){const t=s.jc();s.Fb(2),s.pc("ngForOf",t.frozen_outputs_locked)}}function W(t,e){if(1&t&&s.Sb(0,"app-vote-item",12),2&t){const t=e.$implicit,n=s.jc(2);s.pc("output",t)("height",n.height)("blocktime",n.blocktime)("reward",n.rewards[t.hash])("icon","assets/icon/DNA.png")}}function y(t,e){if(1&t&&(s.Xb(0,"div"),s.Sb(1,"h2",13),s.Gc(2,W,1,5,"app-vote-item",10),s.Wb()),2&t){const t=s.jc();s.Fb(2),s.pc("ngForOf",t.frozen_outputs_unlocked)}}const I=[{path:":symbol",component:(()=>{class t{constructor(t,e,n){this.activatedRoute=t,this.metaverseService=e,this.walletService=n,this.frozen_outputs_locked=[],this.frozen_outputs_unlocked=[],this.availableUtxos={},this.rewards={},this.decimals=4,this.checkElection=()=>this.walletService.openLink("https://"+this.electionURL()),this.electionURL=()=>"www.dnavote.com",this.openLink=t=>this.walletService.openLink(t),this.selectedAsset=this.activatedRoute.snapshot.params.symbol}ngOnInit(){}ionViewDidEnter(){this.metaverseService.getHeight().then(t=>(this.height=t,Promise.all([this.getBlocktime(t),this.calculateFrozenOutputs(t)])))}getBlocktime(t){return this.metaverseService.getBlocktime(t).then(t=>{this.blocktime=t}).catch(t=>{console.error(t.message)})}calculateFrozenOutputs(t){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.metaverseService.getFrozenOutputs(this.selectedAsset),n=yield this.metaverseService.getTransactionMap();this.frozen_outputs_locked=[],this.frozen_outputs_unlocked=[];let o=[],i=[];e.forEach(e=>{const c=n[e.hash];for(let t=0;t<c.outputs.length;t++){const n=c.outputs[t];"message"===n.attachment.type&&/^vote_([a-z0-9]+)\:([A-Za-z0-9-_@\.]+)$/.test(n.attachment.content)&&(e.voteType=/^vote_([a-z0-9]+)\:/.test(n.attachment.content)?n.attachment.content.match(/^vote_([a-z0-9]+)\:/)[1]:"Invalid Type",e.voteAvatar=/\:([A-Za-z0-9-_@\.]+)$/.test(n.attachment.content)?n.attachment.content.match(/\:([A-Za-z0-9-_@\.]+)$/)[1]:"Invalid Avatar")}t>e.locked_until?(this.frozen_outputs_unlocked.push(e),i.push(e.hash)):(this.frozen_outputs_locked.push(e),o.push(e.hash))});let c=o&&o.length>0?yield this.walletService.getElectionRewards(o):void 0,r=c&&c.result?c.result:[],a=yield this.walletService.getElectionRewards(i);r=r.concat(a?a.result:[]),r&&r.forEach(t=>{this.rewards[t.txid]=t.reward})}))}}return t.\u0275fac=function(e){return new(e||t)(s.Rb(r.a),s.Rb(u.a),s.Rb(l.a))},t.\u0275cmp=s.Lb({type:t,selectors:[["app-vote"]],decls:26,vars:3,consts:[["slot","start"],["defaultHref","/account/mst"],["translate","VOTE.TITLE"],["align","center"],["translate","VOTE.INFORMATION"],[1,"pointer",3,"click"],["translate","VOTE.INFORMATION_BAYVIEW"],["translate","VOTE.INFORMATION_DNA"],[4,"ngIf"],["translate","VOTE.HISTORY_LOCKED",1,"center"],[3,"output","height","blocktime","reward","icon",4,"ngFor","ngForOf"],["align","center","translate","VOTE.UNLOCK_APPROXIMATION_INFORMATION"],[3,"output","height","blocktime","reward","icon"],["translate","VOTE.HISTORY_UNLOCKED",1,"center"]],template:function(t,e){1&t&&(s.Xb(0,"ion-header"),s.Xb(1,"ion-toolbar"),s.Xb(2,"ion-buttons",0),s.Sb(3,"ion-back-button",1),s.Wb(),s.Sb(4,"ion-title",2),s.Wb(),s.Wb(),s.Xb(5,"ion-content"),s.Xb(6,"ion-row"),s.Xb(7,"ion-col"),s.Xb(8,"p",3),s.Sb(9,"span",4),s.Xb(10,"a",5),s.fc("click",(function(){return e.checkElection()})),s.Ic(11),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(12,"ion-row"),s.Xb(13,"ion-col"),s.Xb(14,"p",3),s.Sb(15,"span",6),s.Xb(16,"a",5),s.fc("click",(function(){return e.openLink("https://www.bayviewplatform.com/")})),s.Ic(17,"www.bayviewplatform.com"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Xb(18,"ion-row"),s.Xb(19,"ion-col"),s.Xb(20,"p",3),s.Sb(21,"span",7),s.Xb(22,"a",5),s.fc("click",(function(){return e.openLink("https://mvsdna.com/")})),s.Ic(23,"mvsdna.com"),s.Wb(),s.Wb(),s.Wb(),s.Wb(),s.Gc(24,X,6,1,"div",8),s.Gc(25,y,3,1,"div",8),s.Wb()),2&t&&(s.Fb(11),s.Jc(e.electionURL()),s.Fb(13),s.pc("ngIf",e.frozen_outputs_locked&&e.frozen_outputs_locked.length),s.Fb(1),s.pc("ngIf",e.frozen_outputs_unlocked&&e.frozen_outputs_unlocked.length))},directives:[c.u,c.X,c.j,c.f,c.g,c.V,p.a,c.r,c.K,c.q,o.m,o.l,k],styles:[""]}),t})()}];let S=(()=>{class t{}return t.\u0275mod=s.Pb({type:t}),t.\u0275inj=s.Ob({factory:function(e){return new(e||t)},imports:[[r.j.forChild(I)],r.j]}),t})();var T=n("iTUp");let E=(()=>{class t{}return t.\u0275mod=s.Pb({type:t}),t.\u0275inj=s.Ob({factory:function(e){return new(e||t)},imports:[[o.c,i.e,c.Y,p.c.forChild(),T.a]]}),t})(),P=(()=>{class t{}return t.\u0275mod=s.Pb({type:t}),t.\u0275inj=s.Ob({factory:function(e){return new(e||t)},imports:[[o.c,i.e,c.Y,E,p.c.forChild(),S]]}),t})()},q5gJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("fXoL");let i=(()=>{class t{transform(t,e){return(t/Math.pow(10,e)).toLocaleString(void 0,{maximumFractionDigits:e})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Qb({name:"format",type:t,pure:!0}),t})()}}]);